<!DOCTYPE html>
<html typeof="bibo:Document " prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#" lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="dc:language" content="en" lang="">
  <style>
    /*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/
    
    .hljs {
      display: block;
      overflow-x: auto;
      padding: 0.5em;
      color: #333;
      background: #f8f8f8;
    }
    
    .hljs-comment,
    .hljs-quote {
      color: #998;
      font-style: italic;
    }
    
    .hljs-keyword,
    .hljs-selector-tag,
    .hljs-subst {
      color: #333;
      font-weight: bold;
    }
    
    .hljs-number,
    .hljs-literal,
    .hljs-variable,
    .hljs-template-variable,
    .hljs-tag .hljs-attr {
      color: #008080;
    }
    
    .hljs-string,
    .hljs-doctag {
      color: #d14;
    }
    
    .hljs-title,
    .hljs-section,
    .hljs-selector-id {
      color: #900;
      font-weight: bold;
    }
    
    .hljs-subst {
      font-weight: normal;
    }
    
    .hljs-type,
    .hljs-class .hljs-title {
      color: #458;
      font-weight: bold;
    }
    
    .hljs-tag,
    .hljs-name,
    .hljs-attribute {
      color: #000080;
      font-weight: normal;
    }
    
    .hljs-regexp,
    .hljs-link {
      color: #009926;
    }
    
    .hljs-symbol,
    .hljs-bullet {
      color: #990073;
    }
    
    .hljs-built_in,
    .hljs-builtin-name {
      color: #0086b3;
    }
    
    .hljs-meta {
      color: #999;
      font-weight: bold;
    }
    
    .hljs-deletion {
      background: #fdd;
    }
    
    .hljs-addition {
      background: #dfd;
    }
    
    .hljs-emphasis {
      font-style: italic;
    }
    
    .hljs-strong {
      font-weight: bold;
    }
  </style>
  <style id="respec-mainstyle">
    /*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/
    /* Override code highlighter background */
    
    .hljs {
      background: transparent !important;
    }
    /* --- INLINES --- */
    
    em.rfc2119 {
      text-transform: lowercase;
      font-variant: small-caps;
      font-style: normal;
      color: #900;
    }
    
    h1 acronym,
    h2 acronym,
    h3 acronym,
    h4 acronym,
    h5 acronym,
    h6 acronym,
    a acronym,
    h1 abbr,
    h2 abbr,
    h3 abbr,
    h4 abbr,
    h5 abbr,
    h6 abbr,
    a abbr {
      border: none;
    }
    
    dfn {
      font-weight: bold;
    }
    
    a.internalDFN {
      color: inherit;
      border-bottom: 1px solid #99c;
      text-decoration: none;
    }
    
    a.externalDFN {
      color: inherit;
      border-bottom: 1px dotted #ccc;
      text-decoration: none;
    }
    
    a.bibref {
      text-decoration: none;
    }
    
    cite .bibref {
      font-style: normal;
    }
    
    code {
      color: #C83500;
    }
    
    th code {
      color: inherit;
    }
    /* --- TOC --- */
    
    .toc a,
    .tof a {
      text-decoration: none;
    }
    
    a .secno,
    a .figno {
      color: #000;
    }
    
    ul.tof,
    ol.tof {
      list-style: none outside none;
    }
    
    .caption {
      margin-top: 0.5em;
      font-style: italic;
    }
    /* --- TABLE --- */
    
    table.simple {
      border-spacing: 0;
      border-collapse: collapse;
      border-bottom: 3px solid #005a9c;
    }
    
    .simple th {
      background: #005a9c;
      color: #fff;
      padding: 3px 5px;
      text-align: left;
    }
    
    .simple th[scope="row"] {
      background: inherit;
      color: inherit;
      border-top: 1px solid #ddd;
    }
    
    .simple td {
      padding: 3px 10px;
      border-top: 1px solid #ddd;
    }
    
    .simple tr:nth-child(even) {
      background: #f0f6ff;
    }
    /* --- DL --- */
    
    .section dd>p:first-child {
      margin-top: 0;
    }
    
    .section dd>p:last-child {
      margin-bottom: 0;
    }
    
    .section dd {
      margin-bottom: 1em;
    }
    
    .section dl.attrs dd,
    .section dl.eldef dd {
      margin-bottom: 0;
    }
    
    .respec-hidden {
      display: none;
    }
    
    #respec-ui {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 202px;
      text-align: right;
    }
    
    #respec-pill,
    .respec-info-button {
      background: #fff;
      height: 2.5em;
      color: rgb(120, 120, 120);
      border: 1px solid #ccc;
      box-shadow: 1px 1px 8px 0 rgba(100, 100, 100, .5);
    }
    
    .respec-info-button {
      border: none;
      border-radius: 2em;
      margin-right: 1em;
      min-width: 3.5em;
    }
    
    #respec-pill:disabled {
      margin: 10px auto;
      font-size: 2.8px;
      position: relative;
      text-indent: -9999em;
      border-top: 1.1em solid rgba(40, 40, 40, 0.2);
      border-right: 1.1em solid rgba(40, 40, 40, 0.2);
      border-bottom: 1.1em solid rgba(40, 40, 40, 0.2);
      border-left: 1.1em solid #ffffff;
      transform: translateZ(0);
      animation: respec-spin 1.1s infinite linear;
      box-shadow: none;
    }
    
    #respec-pill:disabled,
    #respec-pill:disabled:after {
      border-radius: 50%;
      width: 10em;
      height: 10em;
    }
    
    @keyframes respec-spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
    
    #respec-pill:hover,
    #respec-pill:focus {
      color: rgb(0, 0, 0);
      transition: color .2s
    }
    
    #respec-menu {
      font-family: sans-serif;
      background: #fff;
      box-shadow: 1px 1px 8px 0 rgba(100, 100, 100, .5);
      width: 200px;
      display: none;
      text-align: left;
      margin-top: 5px;
      font-size: .8em;
    }
    
    .respec-save-button {
      background: #fff;
      border: 1px solid #000;
      border-radius: 5px;
      padding: 5px;
      margin: 5px;
      display: block;
      width: 100%;
      color: #000;
      text-decoration: none;
      text-align: center;
      font-size: inherit;
    }
    
    #respec-ui button:focus,
    #respec-pill:focus,
    .respec-option:focus {
      outline: 0;
      outline-style: none;
    }
    
    #respec-ui button.respec-pill-error {
      background-color: red;
      color: white;
    }
    
    #respec-ui button.respec-pill-warning {
      background-color: orange;
      color: white;
    }
    
    #respec-menu button.respec-option {
      background: white;
      border: none;
      width: 100%;
      text-align: left;
      font-size: inherit;
      padding: 1.2em 1.2em;
    }
    
    #respec-menu button.respec-option:hover {
      background-color: #eeeeee;
    }
    
    .respec-cmd-icon {
      padding-right: .5em;
    }
    
    #respec-ui button.respec-option:last-child {
      border: none;
      border-radius: inherit;
    }
    
    @media print {
      .removeOnSave {
        display: none;
      }
    }
  </style>

  <title>Volkswagen Infotainment Web Interface protocol definition</title>

  <link rel="stylesheet" href="../css/default.css">
  <link rel="stylesheet" href="../css/github.css">
  <link rel="stylesheet" href="../css/markdown.css">
  <link rel="stylesheet" href="../css/page.css">


  <meta name="generator" content="ReSpec Developer Edition">
  <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-Member-SUBM">
</head>
<body class="h-entry">
  <div class="head">
    <p>
      <a class="logo" href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C" width="72" height="48"></a>
      <a href="https://www.w3.org/Submission/"> <img alt="W3C Member Submission" src="https://www.w3.org/Icons/member_subm" width="211" height="48"></a>
    </p>
    <h1 class="title p-name" id="title" property="dcterms:title">Volkswagen Infotainment Web Interface protocol definition</h1>
    <h2><abbr title="World Wide Web Consortium">W3C</abbr> Member Submission <time property="dcterms:issued" class="dt-published" datetime="2016-12-13">13 December 2016</time></h2>
    <dl>
      <dt>This version:</dt>
      <dd><a class="u-url" href="https://www.w3.org/Submission/2016/SUBM-viwi-protocol-20161213/">https://www.w3.org/Submission/2016/SUBM-viwi-protocol-20161213/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="https://www.w3.org/Submission/viwi-protocol/">https://www.w3.org/Submission/viwi-protocol/</a></dd>
      <dt>Editor:</dt>
      <dd class="p-author h-card vcard" property="bibo:editor" resource="_:editor0" data-editor-id="95295"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Dr. Patrick Bartsch</span>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://www.volkswagenag.com">Volkswagen AG</a></span>
        <span property="rdf:rest" resource="rdf:nil"></span>
      </dd>

    </dl>
    <p class="copyright">Copyright © 2016 <span class="notetoeditor"></span>.
                This document is available under the <a href="http://www.w3.org/Consortium/Legal/copyright-documents">W3C
                    Document License</a>. See the <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">W3C
                    Intellectual Rights Notice and Legal Disclaimers</a> for additional
                information.</p>
    <hr title="Separator for header">
  </div>

  <!--
  <section id="abstract" class="introductory" property="dc:abstract">
    <h2>Abstract</h2>
    <p>

    </p>
  </section>
-->
  <section id="sotd" class="introductory">
    <h2>Status of This Document</h2>
    <p>
      <em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at https://www.w3.org/TR/.</em>
    </p>

    <p>
      This is required.
    </p>

    <p>By publishing this document, <abbr title="World Wide Web Consortium">W3C</abbr> acknowledges that the <a href="https://www.w3.org/Submission/2016/SUBM-viwi-protocol-20161213/">Submitting Members</a> have made a formal Submission request to <abbr title="World Wide Web Consortium">W3C</abbr> for discussion. Publication of this document by <abbr title="World Wide Web Consortium">W3C</abbr> indicates no endorsement of its content by <abbr title="World Wide Web Consortium">W3C</abbr>, nor that <abbr title="World Wide Web Consortium">W3C</abbr> has, is, or will be allocating any resources to the issues addressed by it. This document is not the product of a chartered <abbr title="World Wide Web Consortium">W3C</abbr> group, but is published as potential input to the <a href="https://www.w3.org/Consortium/Process"><abbr title="World Wide Web Consortium">W3C</abbr> Process</a>. A <a href="https://www.w3.org/Submission/2016/01/Comment/"><abbr title="World Wide Web Consortium">W3C</abbr> Team Comment</a> has been published in conjunction with this Member Submission. Publication of acknowledged Member Submissions at the <abbr title="World Wide Web Consortium">W3C</abbr> site is one of the benefits of <a href="https://www.w3.org/Consortium/Prospectus/Joining"><abbr title="World Wide Web Consortium">W3C</abbr> Membership</a>. Please consult the requirements associated with Member Submissions of <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-submissions">section 3.3 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. Please consult the complete <a href="https://www.w3.org/Submission">list of acknowledged <abbr title="World Wide Web Consortium">W3C</abbr> Member Submissions</a>.</p>
  </section>

  <section>
    <h2 style="text-align: center;">Volkswagen Infotainment Web Interface</h2>
    <article class="markdown-body">
      <p>&nbsp;</p>
      <p></p>
      <h5 style="text-align: center;">protocol definition</h5>
      <p></p>
      <p style="text-align: center;">
        <img src="../img/curlies.png" alt="viwi">
      </p>
      <p style="text-align: center;">by Dr. Patrick Bartsch 2013-2017 </p>
      <p>&nbsp;</p>
      <p style="text-align: center;">version: v 1.8.0-<abbr title="World Wide Web Consortium">W3C</abbr></p>
      <p>&nbsp;</p>

      <h3 id="-a-name-introduction-a-introduction">
        <h2 id="-a-name-introduction-a-introduction"><a name="Introduction"></a>Introduction</h2>
      <h3 id="purpose-of-this-document">Purpose of this document</h3>
      <p>This document provides an overview over web services on the WebInfotainment platform. All services provide mainly HTTP_GET, HTTP_POST, HTTP_PUT, HTTP_DELETE (herein called GET, POST, PUT, DELETE) and WebSocket interfaces. The response is always of contentType: <code>application/json</code> (or <code>application/vnd.viwi.v&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;+json</code> for a <a href="#accessversionedinterface">dedicated version</a>), this also applies for the WebSocket interface. The general approach is a RESTful API.</p>
      <p><img src="img/diagram1.png" alt="Client server architecture"></p>
      <p>The general architecture of a system using the herein defined interfaces is split into WebServer and Client (Figure 1: Example of system architecture). While any client can have different contexts, the web server can have different services providing a number of resources that hold a number of elements. The connection between client and server is always a TCP/IP connection that allows http(s):// and ws(s):// protocols on top.</p>
      <h3 id="paradigms">Paradigms</h3>
      <p>The API described herein follows some general 'design rules' or 'paradigms'. Deviation of actual interface definition must be minimized in a reasonable way.</p>
      <ol>
      <li>
        <p>The depth of the URI tree is limited to 3, i.e. <code>/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;</code>. While <code>&lt;service&gt;</code> and <code>&lt;resource&gt;</code> are predefined in this document, <code>&lt;element&gt;</code> will always be an identifier or the keyword <code>$accessrights</code>, <code>$id</code> or <code>$spec</code>. <code>&lt;resource&gt;</code> is always a collection (e.g stations) and thus has to be a noun plural form, even if the <code>&lt;resource&gt;</code> will only carry one single <code>&lt;element&gt;</code> by design. The  <code>&lt;resource&gt;</code> identifiers must not carry verbs like <code>getAccount</code> or <code>createTrack</code>.</p>
      </li>
      <li>
        <p>An event is considered 'on change' if two subsequent GET requests - with no expansion applied (see <a href="#expansion_concept">Expansion concept</a>) - on the corresponding URI would result in different responses. If an elements property 'name' is changed, an 'on change' event is fired (<a href="#PublishSubscribe">Publish Subscribe</a>). Example: Only if an element is added or removed from a list of objects (on resource level), an 'on change' event is fired (<a href="#PublishSubscribe">Publish Subscribe</a>). If a client wants to get notified on nested properties or structures, the corresponding event has to be subscribed individually at element level.</p>
      </li>
      <li>
        <p>To keep the overall network traffic at a minimum, every resource and element access supports filtering. The response filtering concepts "fields", "paging" and "expand" are generally available.</p>
      </li>
      <li>
        <p>Every object inherits from <a href="#XObject">XObject</a>. I.e. every Object has three mandatory properties: id, uri and name. These properties will be present in every response object.</p>
      <ol>
      <li>
        <p>Every instance inherited from <a href="#XObject">XObject</a> has its own endpoint.</p>
      </li>
      <li>
        <p>An <a href="#XObject">XObject</a> consists only of properties with primitive or complex types and references to other <a href="#XObject">XObject</a> or arrays of those.</p>
      </li>
      </ol>
      </li>
      <li><p>RESTful HTTP calls are the main interface. A client does not necessarily have to register for events, it can also use plain HTTP polling. A polling client will not be automatically updated with the server state. API-Calls that change the server state are responded with a StatusObject only. The altered state has to be accessed via HTTP_GET or by event subscription.</p>
      </li>
      </ol>
      <h3 id="-a-name-httpstatuscodes-a-http-status-codes"><a name="httpstatuscodes"></a>HTTP status codes</h3>
      <p>All services have to follow the W3C/IANA HTTP status code specification (<a href="https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml">Hypertext Transfer Protocol (HTTP) Status Code Registry</a>).</p>
      <p>This section extends each Status-Code with implication and handling information for a client. The general meaning of status codes remains untouched. The client has to be able to work with any response with a status code defined in <a href="https://tools.ietf.org/html/rfc6585">RFC6585</a>, <a href="https://www.ietf.org/rfc/rfc7231.txt">RFC7231</a> and <a href="https://tools.ietf.org/html/rfc7725">RFC7725</a>. In addition to the status code definitions, some status codes are generally not expected by the client, those codes are marked as <em>not applicable</em> in viwi context. Each status code may have a domain specific meaning, which will be described in the according domain section separately. Please note that each service domain may overwrite the <strong>implication</strong> and <strong>client-side treatment</strong>.</p>
      <table>
      <thead>
      <tr>
        <th>Code</th>
        <th>name</th>
        <th>Implication</th>
        <th>Client-side treatment</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.2.1">100</a></td>
        <td>Continue</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.2.2">101</a></td>
        <td>Switching Protocols</td>
        <td>Only used for establishing websockets, see <a href="https://tools.ietf.org/html/rfc6455#section-4.2.2">RFC6455 section 4.2.2</a>.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">200</a></td>
        <td>OK</td>
        <td>Used for successful HTTP Requests. This code is used to acknowledge successful change of the resource or element.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">201</a></td>
        <td>Created</td>
        <td>Used for successfully creating new entities.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.3">202</a></td>
        <td>Accepted</td>
        <td>The request has been accepted for processing, but the processing has not been completed. The request might or might not eventually be acted upon. There is no guarantee that the request will be fullfilled.</td>
        <td>Subscribe to affected entity, if the actual outcome is of interest.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.4">203</a></td>
        <td>Non-Authoritative Information</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.5">204</a></td>
        <td>No Content</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.6">205</a></td>
        <td>Reset Content</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7233#section-4.1">206</a></td>
        <td>Partial Content</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.4.1">300</a></td>
        <td>Multiple Choices</td>
        <td>Used if multiple services match the request criteria (service registry only)</td>
        <td>Client has to select and re-request</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.4.2">301</a></td>
        <td>Moved Permanently</td>
        <td>Not applicable, see <a href="#service_registry">service registry</a>.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.4.3">302</a></td>
        <td>Found</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.4.4">303</a></td>
        <td>See Other</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7232#section-4.1">304</a></td>
        <td>Not Modified</td>
        <td>If the entity is not modified, this status code can be sent. This indicates that the client should look for this entity in its cache.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.4.5">305</a></td>
        <td>Use Proxy</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.4.7">307</a></td>
        <td>Temporary Redirect</td>
        <td>The requested resource has moved. The new location is send as an absolute URL in the response HTTP-Header <code>Location</code> field.</td>
        <td>Client should submit a new HTTP request.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">400</a></td>
        <td>Bad Request</td>
        <td>The client submitted a malformed request, repeating the request will not help.</td>
        <td>Client has to make sure to send a valid request.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7235#section-3.1">401</a></td>
        <td>Unauthorized</td>
        <td>This request requires authentication.</td>
        <td>If client is not authenticated, client has to authenticate.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.2">402</a></td>
        <td>Payment Required</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.3">403</a></td>
        <td>Forbidden</td>
        <td>The client has insufficient rights to obtain the requested information or has submitted an HTTP request with POST method to a property, which is <code>read-only</code> or not allowed to be set by the client(e.g. <code>POST</code> on <code>/car/info</code> property <code>vehicleIdentication</code>).</td>
        <td>If client do not have access rights, client has to acquire access rights.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">404</a></td>
        <td>Not Found</td>
        <td>The service cannot find the entity, this may be a permanent or temporary condition.  Do not expect elements to be generally available. This status code is treated as a valid response. <strong>Use-case specific error handling is required.</strong></td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">405</a></td>
        <td>Method Not Allowed</td>
        <td>Not applicable, because all possible HTTP-Methods are defined by the the viwi document and missing privileges are singnaled by status code 403.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.6">406</a></td>
        <td>Not Acceptable</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7235#section-3.2">407</a></td>
        <td>Proxy Authentication Required</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.7">408</a></td>
        <td>Request Time-out</td>
        <td>Not applicable. The request sent to the server took longer than the server was prepared to wait. In other words, client connection with server "timed out". Server configuration should rule out this error.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.8">409</a></td>
        <td>Conflict</td>
        <td>It is not possible to establish the required state. This might be the case if a client wants to set an objects property that is not writable or that currently can not be set. The <code>message</code> property of <a href="#statusobject">StatusObject</a> may have information for the client to recognize the source of the conflict. This information is only for debugging and development purposes.</td>
        <td>Resource specific treatment is necessary (e.g. media audioSource might be disabled during navigation announcements,  the clients tries to un-mute media). See <a href="https://tools.ietf.org/html/rfc7231#section-6.5.8">RFC7231 section 6.5.8</a> for more information.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.9">410</a></td>
        <td>Gone</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.10">411</a></td>
        <td>Length Required</td>
        <td>Not applicable, see  <a href="https://tools.ietf.org/html/rfc7231#section-6.5.10">RFC7231 section 6.5.10</a>.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7232#section-4.2">412</a></td>
        <td>Precondition Failed</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.11">413</a></td>
        <td>Request Entity Too Large</td>
        <td>Not applicable, see <a href="#paging">paging</a>.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.12">414</a></td>
        <td>Request-URI Too Large</td>
        <td>Not applicable, see <a href="https://tools.ietf.org/html/rfc7231#section-6.5.12">RFC7231 section 6.5.12</a>.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">415</a></td>
        <td>Unsupported Media Type</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7233#section-4.4">416</a></td>
        <td>Requested range not satisfiable</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.14">417</a></td>
        <td>Expectation Failed</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
       <td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.15">426</a></td>
        <td>Upgrade Required</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc6585#section-3">428</a></td>
        <td>Precondition Required</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc6585#section-4">429</a></td>
        <td>Too Many Requests</td>
        <td>The user has sent too many requests in a given amount of time.</td>
        <td>Used to rate-limit access to a certain resource or element</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc6585#section-5">431</a></td>
        <td>Request Header Fields Too Large</td>
        <td>Client send header fields which are to large or not correctly formated</td>
        <td>Send smaller and correct header fields</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7725#section-3">451</a></td>
        <td>Unavailable For Legal Reasons</td>
        <td>A server operator has received a legal demand to deny access to a resource or to a set of resources that includes the requested resource.</td>
        <td>Sent, when for any legal reason access to a resource or element is (temporarily) blocked</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">500</a></td>
        <td>Internal Server Error</td>
        <td>The server encountered an unexpected condition which prevented it from fulfilling the request.</td>
        <td>There is no client-side fix/solution for this kind of errors.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.2">501</a></td>
        <td>Not Implemented</td>
        <td>The server does not support the functionality required to fulfill the request. Unless specified otherwise in service specific status code handling, this error indicates a not-permitted error.</td>
        <td>Not applicable.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.3">502</a></td>
        <td>Bad Gateway</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.4">503</a></td>
        <td>Service Unavailable</td>
        <td>Service is currently unable to handle the request. This implies a temporary problem which will be solved after a given delay. If known, the delay <strong>may</strong> be indicated in a <code>Retry-After</code> header.</td>
        <td>Client should retry to submit the request after delay.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.5">504</a></td>
        <td>Gateway Time-out</td>
        <td>The request can not be fulfilled because server acts as a proxy and did not receive a timely response from remote component (e.g. ECU of driver assistance).</td>
        <td>There is no client-side fix/solution for this kind of error. If the remote component is expected to be reachable after a delay in this power-cycle then server sends a response with status code 503.</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.6">505</a></td>
        <td>HTTP Version not supported</td>
        <td>Not applicable.</td>
        <td>None</td>
      </tr>
      <tr>
        <td><a href="https://tools.ietf.org/html/rfc6585#section-6">511</a></td>
        <td>Network Authentication Required</td>
        <td>The connection to the vehicle infrastructure is not authenticated.</td>
        <td>Reauthenticate the connection channel.</td>
      </tr>
      </tbody>
      </table>
      <h4 id="handling-service-responses-with-respecting-status-codes">Handling service responses with respecting status codes</h4>
      <p>To communicate with the services a client submits an HTTP request and waits for the response. A response is always sent with a status code. The service uses the pre-defined status codes when sending a response. Each client interprets the response with the respective status code.</p>
      <p>Each status code is categorized as successful (2xx), redirection (3xx), client error (4xx) or server error (5xx). If status code is not successful, then the response must be handled by the client as following:</p>
      <ul>
        <li>If an error can be treated by a client, it is categorized as <strong>permitted errors</strong>. For each permitted error a treatment is defined.</li>
        <li>If an error can not be treated by the client, it is categorized as <strong>not permitted error</strong>.</li>
        <li>Each service domain may define, which errors are <strong>permitted</strong> and <strong>not permitted</strong>.</li>
      </ul>
      <h3 id="restful-api">RESTful API</h3>
      <h4 id="general-information">General information</h4>
      <p>The REST architectural style describes six constraints:</p>
      <ul>
      <li>uniform interface (resource based, self descriptive, ...)</li>
      <li>statelessness (necessary state to handle the request is contained within the request itself)</li>
      <li>cacheability (clients can cache responses)</li>
      <li>client-server architecture (uniform interface separates client and server)</li>
      <li>layered system (client cannot ordinarily tell whether it is connected directly or intermediary)</li>
      <li>code on demand <code>optional</code> (Servers are able to temporarily extend or customize the functionality of a client by transferring logic to it)</li>
      </ul>
      <p>Conforming to the REST architectural style, will enable any kind of distributed system to have desirable emergent characteristics, such as performance, scalability, simplicity, modifiability, visibility, portability and reliability.</p>
      <p>These constraints, applied to the architecture, were originally communicated by Roy Fielding in his doctoral dissertation and define the basis of RESTful-style.</p>
      <p>Source: <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm</a></p>
      <h5 id="uniform-interface">Uniform interface</h5>
      <p>The uniform interface constraint defines the interface between clients and servers. It simplifies and decouples the architecture, which enables each part to evolve independently. The four guiding principles of the uniform interface are:</p>
      <h6 id="resource-based">Resource-based</h6>
      <p>Individual resources are identified in requests using URIs as resource identifiers. The resources themselves are conceptually separate from the representations that are returned to the client. For example, the server does not send its database, but rather, some HTML, XML or JSON that represents some database records. For instance data for a finish client, in Finnish language and encoded in UTF-8, depending on the details of the request and the server implementation.</p>
      <h6 id="manipulation-of-resources-through-representations">Manipulation of resources through representations</h6>
      <p>When a client holds a representation of a resource, including any meta data attached, it has enough information to modify or delete the resource on the server, provided it has permission to do so.</p>
      <h6 id="self-descriptive-messages">Self-descriptive messages</h6>
      <p>Each message includes enough information to describe how to process the message. For example, which parser to invoke may be specified by an Internet media type (previously known as a MIME type). Responses also explicitly indicate their cache-ability.</p>
      <h6 id="hypermedia-as-the-engine-of-application-state-hateoas-">Hypermedia as the engine of application state (HATEOAS)</h6>
      <p>Clients deliver state via body contents, query-string parameters, request headers and the requested URI (the resource name). Services deliver state to clients via body content, response codes, and response headers. This is technically referred-to as hypermedia (or hyperlinks within hypertext).
      Aside from the description above, HATEOAS also means that, where necessary, links are contained in the returned body (or headers) to supply the URI for retrieval of the object itself or related objects.</p>
      <p>The uniform interface that any REST services must provide is fundamental to its design.</p>
      <h5 id="statelessness">Statelessness</h5>
      <p>As REST is an acronym for REpresentational State Transfer, statelessness is key. Essentially, what this means is that the necessary state to handle the request is contained within the request itself, whether as part of the URI, query-string parameters, body, or headers. The URI uniquely identifies the resource and the body contains the state (or state change) of that resource. Then after the server does it's processing, the appropriate state, or the piece(s) of state that matter, are communicated back to the client via headers, status and response body.
      Classical - statefull - API design provides us with the concept of programming within a container which maintains state across multiple HTTP requests. In REST, the client must include all information for the server to fulfill the request, resending state as necessary if that state must span multiple requests. Statelessness enables greater scalability since the server does not have to maintain, update or communicate that session state. Additionally, load balancers don't have to worry about session affinity for stateless systems.
      So what's the difference between state and a resource? State, or application state, is the one which the server cares about to fulfill a request - data necessary for the current session or request. A resource, or resource state, is the data that defines the resource representation — the data stored in the database, for instance. Consider application state to be data that could vary by client, and per request. Resource state, on the other hand, is constant across every client who requests it.
      Ever had back-button issues with a web application where it went AWOL (Absent Without Official Leave - military jargon) at a certain point because it expected you to do things in a certain order? That's because it violated the statelessness principle. There are cases that don't honor the statelessness principle, such as three-legged OAuth, API call rate limiting, etc. However, make every effort to ensure that application state doesn't span multiple requests of your service(s).</p>
      <h5 id="cacheability">Cacheability</h5>
      <p>As on the World Wide Web, clients can cache responses. Responses must therefore, implicitly or explicitly, define themselves as cacheable, or not, to prevent clients reusing stale or inappropriate data in response to further requests. Well-managed caching partially or completely eliminates some client-server interactions, further improving scalability and performance.</p>
      <h5 id="client-server-architecture">Client-server architecture</h5>
      <p>The uniform interface separates clients from servers. This separation of concerns means that, for example, clients are not concerned with data storage, which remains internal to each server, so that the portability of client code is improved. Servers are not concerned with the user interface or user state, so that servers can be simpler and more scalable. Servers and clients may also be replaced and developed independently, as long as the interface is not altered.</p>
      <h5 id="layered-system">Layered system</h5>
      <p>A client cannot ordinarily tell whether it is connected directly to the end server, or to an intermediary along the way. Intermediary servers may improve system scalability by enabling load-balancing and by providing shared caches. Layers may also enforce security policies.</p>
      <h5 id="code-on-demand-optional-">Code-on-demand <code>optional</code></h5>
      <p>Servers are able to temporarily extend or customize the functionality of a client by transferring logic to it that it can execute. Examples of this may include compiled components such as Java applets and client-side scripts such as JavaScript.</p>
      <h4 id="application-to-viwi">Application to viwi</h4>
      <p>The interfaces described inhere follow the RESTful principles. The main concept in REST is the existence of resources (sources of specific information or services), each of which is referenced with a <code>uri</code> as global identifier. The RESTful API is used to retrieve information for the client (request) from the server (response), while Events provide a channel for communication in server to client direction (push information). The supported HTTP request methods are GET, POST, PUT and DELETE. The following table explains the main principle of interface definition for all services defined hereafter:</p>
      <table>
        <thead>
          <tr>
            <th>
              <em>type</em>
            </th>
            <th>
              <em>GET</em> (HTTP)</th>
            <th>
              <em>POST</em> (HTTP)</th>
            <th>
              <em>PUT</em> (HTTP)</th>
            <th>
              <em>DELETE</em> (HTTP)</th>
            <th>
              <em>subscribe</em> (WebSocket)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>root URI, such as
              <code>/</code> or
              <code>/api/v1/</code>
            </td>
            <td>
              <strong>List</strong> the URIs and perhaps other details of the service known to the system.</td>
            <td>n/a</td>
            <td>
              <strong>Register new service</strong> with the system. The new service's URI is assigned automatically and is returned by the
              operation.</td>
            <td>n/a</td>
            <td>Get updated on
              <strong>collection changes</strong> (e.g. addition, removal of elements)</td>
          </tr>
          <tr>
            <td>service URI, such as
              <code>/&lt;service&gt;/</code>
            </td>
            <td>
              <strong>List</strong> all elements matching the request (including query parameters).</td>
            <td>n/a</td>
            <td>n/a</td>
            <td>
              <strong>De-Register new service</strong> with the system.
              <code>&lt;service&gt;</code> has to be accessed by its uuid. (special permissions needed)</td>
            <td>Get updated on
              <strong>collection changes</strong> (e.g. addition, removal of elements)</td>
          </tr>
          <tr>
            <td>Resource URI, such as
              <code>/&lt;service&gt;/&lt;resource&gt;/</code>
            </td>
            <td>
              <strong>List</strong> the URIs and perhaps other details of the collection's members.</td>
            <td>
              <strong>Create new element</strong> in collection or simultaneously
              <strong>change a collecton of elements</strong>. The new element's URI is assigned automatically and is returned by the operation.</td>
            <td>n/a</td>
            <td>n/a</td>
            <td>Get updated on
              <strong>collection changes</strong> (e.g. addition, removal of elements)</td>
          </tr>
          <tr>
            <td>Element URI, such as
              <code>/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;</code>
            </td>
            <td>
              <strong>Retrieve</strong> a representation of the addressed
              <strong>member</strong> of the collection, expressed in an appropriate Internet media type.</td>
            <td>
              <strong>Update element</strong>. The updated element's URI is assigned automatically and is returned by the operation.</td>
            <td>
              <strong>Create new element</strong> in collection by sending the entire entity. The new element's URI is assigned accordingly.</td>
            <td>
              <strong>Delete</strong> the referred entity of the collection (or its attributes)</td>
            <td>Get updated on
              <strong>element changes</strong> (e.g. playing tracks offset on media player)</td>
          </tr>
        </tbody>
      </table>
      <h5 id="head">HEAD</h5>
      <p>The <code>HEAD</code>(see <a href="https://tools.ietf.org/html/rfc7231#section-4.3.2">RFC7231 section 4.3.2</a>) method is identical to <code>GET</code> except that the server <strong>MUST NOT</strong> return a message-body in the response. The meta information contained in the HTTP headers in response to a HEAD request SHOULD be identical to the information sent in response to a GET request. This method can be used for obtaining meta information about the entity implied by the request without transferring the entity-body itself. The method is often used to obtain information about expiry or existence, specially in cases where cross origin resource sharing (<a href="#CORS">CORS</a>) is needed.</p>
      <h5 id="delete">DELETE</h5>
      <p>A client can either delete entire <code>&lt;element&gt;</code>s or just properties on the <code>&lt;element&gt;</code>s properties specified in the <code>$fields</code> query parameters. The mandatory fields <code>id</code>, <code>name</code> and <code>uri</code> can not be deleted. In case of a writable <code>name</code> property on an <code>&lt;element&gt;</code>, a client can reset the name to <code>""</code> by POSTing.</p>
      <h6 id="example-element-deletion">Example element deletion</h6>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">DELETE <span class="hljs-string">/medialibrary/tracks/01aceb4b-002d-4060-a8eb-81868bf0bc37</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span>
      </span>}</span></code>
      </code></pre><h6 id="example-deletion-of-element-properties-artists-and-rating">Example deletion of element properties artists and rating</h6>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">DELETE <span class="hljs-string">/medialibrary/tracks/01aceb4b-002d-4060-a8eb-81868bf0bc37?$fields=artists,rating</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span>
      </span>}</span></code>
      </code></pre><h5 id="post">POST</h5>
      <p>Creating or changing an entity should always be done in the most condensed way (one request) possible, except the client explicitly wants to execute a sequence.</p>
      <p>Creating e.g. an element is possible by providing no additional information in some cases and later in time modifying the newly created element to the desired state is possible. Nevertheless, providing all known information with the initial request ensures object integrity and minimum network traffic at the same time.</p>
      <p>Changing an element's properties subsequently may cause unwanted effects like flickering in the maprenderer's case or jumps in the mediarenderer's case.</p>
      <p>The protocol is based on the <strong>last-wins</strong> principle, i.e. last update arriving at the server determines the final state, disregarding the actual time gap between arrival of two subsequent requests.</p>
      <h5 id="delete-collection-of-elements">DELETE collection of elements</h5>
      <p>In order to allow simultaneous deletion of different elements, combining query parameters as known from a <code>GET</code> request with a <code>DELETE</code> query on <code>&lt;resource&gt;</code> is used. The idea behind is that a query will select a sub-collection (filter) of the <code>&lt;resource&gt;</code>s elements for which the <code>DELETE</code> action shall be applied. The request will only return a success if all deletions were successful, it will fail and return an appropriate code otherwise.</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">DELETE <span class="hljs-string">/addressbook/contacts/?id=34a96130-4beb-47ed-b5e5-5a835907e0eb,2fb85b19-6eb6-49c1-87c5-dcb987aa23d6</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span>
      </span>}</span></code>
      </code></pre><h5 id="post-to-change-a-collection-of-elements">POST to change a collection of elements</h5>
      <p>In order to allow simultaneous updates on different elements, combining query parameters as known from a <code>GET</code> request with a <code>POST</code> query on <code>&lt;resource&gt;</code> is used. The idea behind is that a query will select a sub-collection (filter) of the <code>&lt;resource&gt;</code>s elements for which the <code>POST</code> action shall be applied. This is particularly useful for multi-element-transactions such as setting the color of multiple lights simultaneously. The request will only return a success if all changes were applied successfully, it will fail and return an appropriate code otherwise.</p>
      <h6 id="light-decoration-example">Light decoration example</h6>
      <p>Assuming a desire to change the light color of LEDs simultaneously for two decoration elements with the ids 0dde0b53-b862-44ec-bab2-045c049d220c and 1ca1b74-da9a-4933-baa5-1d6f0669dad0, a combined request would be sent instead of two subsequent ones.</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">POST <span class="hljs-string">/dashboard/decoration/?id=0dde0b53-b862-44ec-bab2-045c049d220c,1ca1b74-da9a-4933-baa5-1d6f0669dad0</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">color</span>": <span class="hljs-value"><span class="hljs-string">"blue"</span>
      </span>}</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span>
      </span>}</span></code>
      </code></pre><h4 id="-a-name-caching-a-caching"><a name="caching"></a>Caching</h4>
      <p>Cache control is established by using HTTP headers <code>ETag</code> and <code>If-None-Match</code> (cmp. <a href="https://tools.ietf.org/html/rfc7232#section-2.3">RFC 7232-2.3</a>). Mainly used for web cache validation, a client can make conditional requests based on the response. This allows caches to be more efficient, saves bandwidth and avoid cache-sync problems as a service does not need to send a full response if the content has not changed and a client can use the cached information. This also applies to service-service communication, especially when service <code>A</code> references element owned by service <code>B</code>. <code>A</code> will act as a client and use its own cached information if no changes where detected by <code>B</code>.</p>
      <p>The basic sequence is:
      First: ask for an entity</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/cdn/images/foo.png</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">image/*</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">image/png</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"641abf"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      <span class="hljs-attribute">Content-Length</span>: <span class="hljs-string">15360</span>
      
      <span class="apache">
      <span class="hljs-tag">&lt;base64encodedfile&gt;</span></span></code>
      </code></pre><p>The client uses the content delivered with the response, stores the <code>ETag</code> info with the entity in its cache.</p>
      <p>Second: later ask for the same entity together with <code>If-None-Match</code></p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/cdn/images/foo.png</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">If-None-Match</span>: <span class="hljs-string">"641abf"</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">image/*</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">304</span> Not Modified</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">image/png</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"641abf"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 21:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      <span class="hljs-attribute">Content-Length</span>: <span class="hljs-string">0</span></code>
      </code></pre><p>The client uses the information from its cache, 0 bytes of payload were transfered.</p>
      <h3 id="and-vs-or-queries">AND vs. OR queries</h3>
      <p>Queries are treated as OR queries per query parameter, i.e. <code>GET /api/v1/&lt;service&gt;/&lt;resource&gt;/?name=foo,bar</code> will retrieve all elements whose names equals 'foo' <strong>OR</strong> 'bar'. Using multiple query parameters on the other hand is treated as an <strong>AND</strong> query, e.g. <code>GET /api/v1/&lt;service&gt;/&lt;resource&gt;/?name=foo&amp;type=bar</code> retrieves all elements named 'foo', being of type 'bar'. To obtain elements by OR queries over multiple query parameters, multiple queries are needed to be made and being combined by the client. This also applies to <code>$expand</code>, <code>$fields</code> etc.
      <code>GET /api/v1/&lt;service&gt;/&lt;resource&gt;/?$expand=foo,bar</code> reads like 'please expand the properties whose name is either foo <strong>OR</strong> bar'. <code>GET /api/v1/&lt;service&gt;/&lt;resource&gt;/?name=foo,bar</code> reads like 'give me only those properties whose name is either foo <strong>OR</strong> bar'.</p>
      <h3 id="-a-name-addressingaspects-a-addressing-aspects"><a name="addressingaspects"></a>Addressing aspects</h3>
      <p>The system uses unified resource identifiers (<code>uri</code>s) to reference to entities from and to each other. There are to types of <code>uri</code>s, absolute (e.g. <code>https://127.0.0.1:1337/cdn/images/image001.jpg</code>) and relative (e.g. <code>/cdn/images/image001.jpg</code>). All <code>uri</code>s are absolute by default, only if a service is referencing to information that is available under the same host and port, the <code>uri</code> will be relative. All clients have to send the HTTP <code>Host</code> header when accessing a service. The service will use the information provided by the HTTP <code>Host</code> header to build the absolute <code>uri</code>s. This means that an external client will get <code>uri</code>s based on the external IP address or hostname and port number of the service it is talking to.</p>
      <h3 id="-a-name-cors-a-cross-origin-resource-sharing-cors-"><a name="cors"></a>Cross-origin resource sharing (CORS)</h3>
      <p>Cross-origin resource sharing (CORS) is a mechanism that allows restricted resources (e.g. fonts, JavaScript, etc.) on a web page to be requested from another domain outside the domain from which the resource originated.</p>
      <p>A web page may freely embed images, stylesheets, scripts, iframes, videos and some plugin content from any other domain. However embedded web fonts and AJAX(XMLHttpRequest) requests have traditionally been limited to accessing the same domain as the parent web page (as per the same-origin security policy). "Cross-domain" AJAX requests are forbidden by default because of their ability to perform advanced requests (POST, PUT, DELETE and other types of HTTP requests, along with specifying custom HTTP headers) that introduce many cross-site scripting security issues.</p>
      <p>CORS defines a way in which a browser and server can interact to safely determine whether or not to allow the cross-origin request. It allows for more freedom and functionality than purely same-origin requests, but is more secure than simply allowing all cross-origin requests. It is a recommended standard of the W3C.</p>
      <p>To allow clients (e.g. browsers) which are following these guidelines access to the service, the service must use CORS.</p>
      <p>Source: <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">https://en.wikipedia.org/wiki/Cross-origin_resource_sharing</a>
      Web Server requirements:</p>
      <ul>
      <li>The server must be configured to allow CORS (<a href="http://www.w3.org/TR/cors/">http://www.w3.org/TR/cors/</a>)</li>
      <li>The server must send the CORS header Access-Control-Allow-Origin *</li>
      <li>The server must send the CORS header Access-Control-Expose-Headers 'location'</li>
      <li>The server must send the CORS header Access-Control-Allow-Credentials</li>
      <li>The server must send the CORS header Access-Control-Allow-Methods: GET,HEAD,PUT,PATCH,POST,DELETE</li>
      <li>The server must send the CORS header Access-Control-Allow-Headers: and use as its value the headers it received in the request header Access-Control-Request-Headers:</li>
      </ul>
      <h3 id="request-response-content">Request response content</h3>
      <p>The response is always of contentType: <code>application/json</code> (or <code>application/vnd.viwi.v&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;+json</code>) with <code>charset=UTF-8</code>, expect for binary content. Binary content uses regular HTTP headers according to its MIME-type.</p>
      <p>POST requests only accept payload in the body, no form encoded (HEADER) data is accepted.</p>
      <h3 id="graph-interface">Graph interface</h3>
      <p>A fundamental concept of the API is the graph. All objects can get into relation with each other. The objects
      can be understood as nodes in a graph while the relations between them are the edges in this graph. This relation is expressed by referencing from one object to another in the object structure. For example, a 'media
      renderer' (node) may 'have' (edge) a 'mediaCollection' (node). The 'mediaCollection' (node) itself may
      'contain' (edge) multiple items like a 'track' (node) or a 'video' (node).</p>
      <p><img src="img/graph1.png" alt="Graph API"></p>
      <h3 id="response-filtering">Response filtering</h3>
      <h4 id="reserved-query-parameters">Reserved query parameters</h4>
      <p>An API-query or subscription can contain none, one or multiple parameters that represent the desire to filter a query. All parameters that do not point to an object property, but have a general nature, are prefixed with $. The following paragraphs make use of this rule and give examples.</p>
      <h4 id="resource-search">Resource search</h4>
      <p>A search can be performed on any resource, as either freetext search, parameter search or a combination of both. The parameter search is performed by using request parameters according to the properties of the resources object. The request parameters name has to resemble the objects property name, while its value is the search key. The character "%" (URL encoded: %25) is used as wildcard and can be used anywhere in the search key. Searches are only possible on properties which reference an XObject or primitive or arrays of those (i.e. searches are not possible on properties that are inlined objects). It is possible to combine multiple request parameters in a single search, while combining multiple search keys in a single request is not supported. Thus, a search query always returns the result of an <code>AND</code> query. <code>http://127.0.0.1:1337/medialibrary/tracks/?$q=5&amp;artists=cb4e5462-1ddf-46c1-9b9d-45d6008a1989</code> reads as 'fetch all tracks from the medialibrary that have any property set to 5 AND the the artists property contains cb4e5462-1ddf-46c1-9b9d-45d6008a1989'.
      To perform an <code>OR</code> query, multiple query have to be combined on client side.</p>
      <h5 id="property-search">Property search</h5>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/medialibrary/tracks/?rating=5</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>":<span class="hljs-value">[
          {
          "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span></span>,
          "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"me and my empty wallet"</span></span>,
          "<span class="hljs-attribute">duration</span>":<span class="hljs-value"><span class="hljs-number">42</span></span>,
          "<span class="hljs-attribute">artists</span>":<span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b527-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"ich"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b527-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">albums</span>":<span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"5088aaa0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"where is my car"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/5088aaa0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/FT1hZIPBHX.png"</span></span>,
          "<span class="hljs-attribute">genres</span>":<span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">rating</span>":<span class="hljs-value"><span class="hljs-number">5</span></span>,
          "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span>
          </span>}
        ]
      </span>}</span></code>
      </code></pre><h4 id="property-search-using-freetext">Property search using freetext</h4>
      <p>A freetext search is performed by using the request parameter <code>$q</code>. The search key will be tested against any property value. Freetext search also supports wildcard character "%" (URL encoded: %25).
      Note: <code>Inlined Objects</code> are not handled as primitive types therefore searching within these with <code>$q</code> is not possible.</p>
      <h5 id="example-freetext">Example freetext</h5>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/medialibrary/tracks/?$q=me%20and%20my%20empty%20wallet</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>":<span class="hljs-value">[
          {
          "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span></span>,
          "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"me and my empty wallet"</span></span>,
          "<span class="hljs-attribute">duration</span>":<span class="hljs-value"><span class="hljs-number">42</span></span>,
          "<span class="hljs-attribute">artists</span>":<span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b527-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"ich"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b527-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">albums</span>":<span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"5088aaa0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"where is my car"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/5088aaa0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/FT1hZIPBHX.gif"</span></span>,
          "<span class="hljs-attribute">genres</span>":<span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">rating</span>" : <span class="hljs-value"><span class="hljs-string">"5"</span></span>,
          "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span>
          </span>}
        ]
      </span>}</span></code>
      </code></pre><h5 id="referenced-object">Referenced object</h5>
      <p>To search for a linked object, use its <code>&lt;uuid&gt;</code> as search value on the search key of its property name.</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/medialibrary/tracks/?artists=bb3372f0-b527-11e3-a5e2-0800200c9a66</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>":<span class="hljs-value">[
          {
          "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span></span>,
          "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"me and my empty wallet"</span></span>,
          "<span class="hljs-attribute">duration</span>": <span class="hljs-value"><span class="hljs-number">42</span></span>,
          "<span class="hljs-attribute">artists</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b527-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"ich"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b527-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">albums</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"5088aaa0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"where is my car"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/5088aaa0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/FT1hZIPBHX.png"</span></span>,
          "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">5</span></span>,
          "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span>
          </span>}
        ]
      </span>}</span></code>
      </code></pre><h4 id="fields">Fields</h4>
      <p>Every <code>GET</code> request is filterable by using the request parameter <code>$fields</code>. The parameter accepts a comma separated list of attribute names. For event subscriptions, the <code>$fields</code> parameter can be set as well. The fields defined by <a href="#XObject">XObject</a> are mandatory, i.e. these are always part of the response. If no ‘field’ parameter is given, the client gets an unfiltered response.</p>
      <h4 id="sorting">Sorting</h4>
      <p>Similar to searching, a generic parameter <code>$sortby</code> can be used for <code>GET</code> requests on resource level to describe sorting rules. Accommodate complex sorting requirements by letting the sort parameter take in a list of comma separated fields, each with a possible unary negative to imply descending sort order.</p>
      <p>Every <code>&lt;resource&gt;</code> has a fixed default ordering, i.e. statelessness is given by defining a default sort behavior per <code>&lt;resources&gt;</code>, the <code>$sortby</code> parameter just over-rules the default behavior.</p>
      <pre><code><code class="hljs elixir">  <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/127.0.0.1:1337/medialibrary</span><span class="hljs-regexp">/tracks/</span>?<span class="hljs-variable">$sortby</span>=rating</code>
      </code></pre><p>or</p>
      <pre><code><code class="hljs elixir">  <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/127.0.0.1:1337/medialibrary</span><span class="hljs-regexp">/tracks/</span>?<span class="hljs-variable">$sortby</span>=-rating</code>
      </code></pre><p>Sorting can be combined with searching by adding both request parameters to the query:</p>
      <pre><code><code class="hljs perl">  http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">1337</span>/medialibrary/tracks/?<span class="hljs-variable">$sortby</span>=rating&amp;name=me<span class="hljs-variable">%20an</span><span class="hljs-variable">%my</span><span class="hljs-variable">%20empty</span><span class="hljs-variable">%20wallet</span></code>
      </code></pre><h5 id="ordering-by-primitives">Ordering by primitives</h5>
      <p>Ordering by primitive value properties is possible alphabetical an numerical.</p>
      <h5 id="ordering-by-xobjects-xobject-">Ordering by <a href="#XObject">XObjects</a></h5>
      <p>The default ordering by references to <a href="#XObject">XObjects</a> is defined by the mandatory <code>name</code> member of the object. A service might implement a different behavior that has to be specified per service, if different to the default.</p>
      <h5 id="ordering-by-complex-types">Ordering by complex types</h5>
      <p>Complex types do not provide a default field for sorting. Therefore, sorting on complex types is not supported.</p>
      <h5 id="ordering-by-array-properties">Ordering by array properties</h5>
      <p>Ordering by array of primitive or array of <a href="#XObject">XObjects</a> is solved by comparison similar to string comparison. Instead of comparing characters, array elements are compared. Arrays of inlined objects do not support sorting. Arrays of <a href="#XObject">XObjects</a> follow the default behavior defined for ordering by <a href="#XObject">XObjects</a> regarding comparison.</p>
      <p>Ordering by array of primitive or array of <a href="#XObject">XObjects</a> is solved by comparison similar to string comparison. Instead of comparing characters, array elements are compared. Arrays of inlined objects do not support sorting. Arrays of <a href="#XObject">XObjects</a> follow the default behavior defined for ordering by <a href="#XObject">XObjects</a> regarding comparison.</p>
      <pre><code><code class="hljs prolog">[] &lt; [<span class="hljs-string">"a"</span>,<span class="hljs-string">"b"</span>,<span class="hljs-string">"c"</span>,<span class="hljs-string">"d"</span>] &lt; [<span class="hljs-string">"a"</span>,<span class="hljs-string">"b"</span>,<span class="hljs-string">"d"</span>]</code>
      </code></pre><h3 id="-a-name-expansion_concept-a-the-expansion-concept"><a name="expansion_concept"></a>The expansion concept</h3>
      <p>Some of the services defined in this document deliver objects, that have reference to each other. The media library for example delivers a list of tracks, where every track can have a reference to an album. An album has a list of tracks itself. To avoid having too many circular references, the concept of resolve level is introduced. The default expansion level is 0 and might be 3 at maximum. Every data structure that potentially contains <a href="#XObject">XObjects</a> supports the expansion level request parameter <code>$expand</code>. A client can also request the expansion of certain object references by providing a list of property name on a request. 
      If a query requests on one or more properties to be expanded and also on one certain level, e.g. <code>$expand=foo,bar,3</code>, only the level expansion should be used. The level expansion has priority over described property expansions.</p>
      <p>Expansion does only work on JSON payload. If an object references to binary data, like images, expansion does NOT apply. Of course binary data can NOT be embedded into JSON payload and thus can not be expanded.</p>
      <h4 id="no-expansion">No expansion</h4>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6149c270-b528-11e3-a5e2-0800200c9a66"</span></span>,
          "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"its in my pocket"</span></span>,
          "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"81c816a0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Pop"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/81c816a0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">artists</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b527-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"ich"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b527-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b500-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"du"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b500-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">duration</span>": <span class="hljs-value"><span class="hljs-number">42</span></span>,
          "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">2</span></span>,
          "<span class="hljs-attribute">tracks</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"coin"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"9df7f840-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"wumpel"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/9df7f840-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">discs</span>": <span class="hljs-value"><span class="hljs-number">2</span></span>,
          "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/image09720.png"</span></span>,
          "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66"</span>
        </span>}
      </span>}</span></code>
      </code></pre><h4 id="single-property-expansion">Single property expansion</h4>
      <p>A client might want to expand just a single property on a given element. To achieve single property expansion, a client adds an <code>$expand</code> parameter followed by a comma separated list of property names.</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66?$expand=artists</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6149c270-b528-11e3-a5e2-0800200c9a66"</span></span>,
          "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"its in my pocket"</span></span>,
          "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"81c816a0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Pop"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/81c816a0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">artists</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b527-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"ich"</span></span>,
              "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">5</span></span>,
              "<span class="hljs-attribute">tracks</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"me and my empty wallet"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"9df7f840-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"wumpel"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/9df7f840-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">albums</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"5088aaa0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"where is my car"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/5088aaa0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/image837943.jpg"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b527-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b500-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"du"</span></span>,
              "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"81c816a0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Pop"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/81c816a0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">4</span></span>,
              "<span class="hljs-attribute">tracks</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"coin"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"9df7f840-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"wumpel"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/9df7f840-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">albums</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"5088aaa0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"where is my car"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/5088aaa0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6149c270-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"its in my pocket"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">".dev.portrait2"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b500-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">duration</span>": <span class="hljs-value"><span class="hljs-number">42</span></span>,
          "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">3</span></span>,
          "<span class="hljs-attribute">tracks</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"coin"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"9df7f840-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"wumpel"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/9df7f840-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">discs</span>": <span class="hljs-value"><span class="hljs-number">2</span></span>,
          "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/image834543.jpg"</span></span>,
          "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66"</span>
        </span>}
      </span>}</span></code>
      </code></pre><h4 id="level-expansion">level expansion</h4>
      <p>A client might want to expand all properties on a certain level for a given element. To achieve level expansion, a client adds an <code>$expand</code> parameter followed a number specifying the expansion level (0-3).</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66?$expand=1</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">User-Agent</span>: <span class="hljs-string">Chrome/34.0.1847.137 Safari/537.36</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip,deflate</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6149c270-b528-11e3-a5e2-0800200c9a66"</span></span>,
          "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"its in my pocket"</span></span>,
          "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
              "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">3</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"81c816a0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Pop"</span></span>,
              "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">2</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/81c816a0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">artists</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b527-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"ich"</span></span>,
              "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">5</span></span>,
              "<span class="hljs-attribute">tracks</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"me and my empty wallet"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/1ebe63c0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"9df7f840-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"wumpel"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/9df7f840-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">albums</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"5088aaa0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"where is my car"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/5088aaa0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/image65476.jpg"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b527-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b500-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"du"</span></span>,
              "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"81c816a0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Pop"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/81c816a0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">4</span></span>,
              "<span class="hljs-attribute">tracks</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"coin"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"9df7f840-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"wumpel"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/9df7f840-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">albums</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"5088aaa0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"where is my car"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/5088aaa0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6149c270-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"its in my pocket"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/image837943.jpg"</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b500-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">duration</span>": <span class="hljs-value"><span class="hljs-number">42</span></span>,
          "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">2</span></span>,
          "<span class="hljs-attribute">tracks</span>": <span class="hljs-value">[
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"coin"</span></span>,
              "<span class="hljs-attribute">duration</span>": <span class="hljs-value"><span class="hljs-number">8</span></span>,
              "<span class="hljs-attribute">artists</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b500-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"du"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b500-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">albums</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"5088aaa0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"where is my car"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/5088aaa0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6149c270-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"its in my pocket"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/We9Hv47YeG.jpg"</span></span>,
              "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"81c816a0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Pop"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/81c816a0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">disc</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
              "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/6ec6abc0-b528-11e3-a5e2-0800200c9a66"</span>
            </span>},
            {
              "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"9df7f840-b528-11e3-a5e2-0800200c9a66"</span></span>,
              "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"wumpel"</span></span>,
              "<span class="hljs-attribute">duration</span>": <span class="hljs-value"><span class="hljs-number">13</span></span>,
              "<span class="hljs-attribute">artists</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b527-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"ich"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b527-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"bb3372f0-b500-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"du"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/artists/bb3372f0-b500-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">albums</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"6149c270-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"its in my pocket"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/ZYnb9UpJxU.png"</span></span>,
              "<span class="hljs-attribute">genres</span>": <span class="hljs-value">[
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"81c816a0-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Pop"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/81c816a0-b528-11e3-a5e2-0800200c9a66"</span>
                </span>},
                {
                  "<span class="hljs-attribute">id</span>" : <span class="hljs-value"><span class="hljs-string">"92884410-b528-11e3-a5e2-0800200c9a66"</span></span>,
                  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"Rock"</span></span>,
                  "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/genres/92884410-b528-11e3-a5e2-0800200c9a66"</span>
                </span>}
              ]</span>,
              "<span class="hljs-attribute">disc</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
              "<span class="hljs-attribute">rating</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
              "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/tracks/9df7f840-b528-11e3-a5e2-0800200c9a66"</span>
            </span>}
          ]</span>,
          "<span class="hljs-attribute">discs</span>": <span class="hljs-value"><span class="hljs-number">2</span></span>,
          "<span class="hljs-attribute">image</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/cdn/images/af7643.jpg"</span></span>,
          "<span class="hljs-attribute">uri</span>" : <span class="hljs-value"><span class="hljs-string">"http://127.0.0.1:1337/medialibrary/albums/6149c270-b528-11e3-a5e2-0800200c9a66"</span>
        </span>}
      </span>}</span></code>
      </code></pre><h4 id="-a-name-paging-a-paging"><a name="paging"></a>Paging</h4>
      <p>Every request is filterable by using the request parameter <code>$offset</code> and <code>$limit</code>. Using these parameters, a list response can be offset by <code>$offset</code> and limited to a total length of <code>$limit</code>. E.g. <code>GET /tuner/stations/?$offset=5&amp;$limit=10</code> returns a list of 10 elements in total, starting with the 6th (lists start with index 0) element, closing with the 15th element. Both parameters are applicable for requests and subscriptions. The response and event payload contains a <code>paging</code> object if there are multiple pages to let the client know the previous and next page of results (if applicable). If at least <code>$offset</code> or <code>$limit</code> are provided with the query the <code>paging</code> object is contained in the response.</p>
      <p><code>$offset</code> can be either an integer value or an <code>uuid</code>. E.g. <code>GET /tuner/stations/?$offset=932e5b1e-1848-11e5-b60b-1697f925ec7b&amp;$limit=10</code> returns a list of 10 elements in total, starting with the element <code>932e5b1e-1848-11e5-b60b-1697f925ec7b</code>.</p>
      <p><code>$limit</code> can be any positive or negative integer. Positive values let the returned list start at <code>$offset</code>. Negative values will return a list of elements before the <code>$offset</code>, with <code>$offset</code> being just out of scope for the repsonse, i.e. the <code>$offset</code> will be behind the last element returned.</p>
      <p>The <a href="#pagingobject"><code>PagingObject</code></a> will hold all neccessary information within the <a href="#responseobject"><code>responseObject</code></a>.</p>
      <p><em>Retrieve from the end of a list</em></p>
      <p>To retrieve a list backwards a client might use a query with negative <code>$limit</code> AND negative <code>$offset</code>. The index -1 marks the last element of a list. E.g. <code>GET /tuner/stations/?$offset=-1&amp;$limit=-10</code> will return the last 10 last, <code>$offset=-1</code> marks the last element.</p>
      <p>Paging is not only available on resource level but also on nested lists, even though paging nested lists does not tell the client about the previous and next page. Paging nested lists is only possible together with <code>$fields</code> filtering by adding <code>($offset:&lt;offset&gt;,$limit:&lt;limit&gt;)</code> to the expanded or filtered property name in the query string, link in <code>/addressbook/contacts/?$fields=emails($offset:0,$limit:2)</code>.</p>
      <p><em>Service initiated paging</em></p>
      <p>In case of queries that can not be answered with a single response, a service sends a partial result with paging information attached. E.g. if a client queries <code>/navigation/pois</code> (without any filters), the result list might be too big to transfer, so the service will initiate the paging of the result itself, by sending a certain number of results and setting the paging properties accordingly.</p>
      <h4 id="timestamping">Timestamping</h4>
      <p>All responses can carry an optional relative <code>timestamp</code>. The <code>timestamp</code> is defined as Integer and expresses the time difference in milliseconds between system boot and message creation. The regular interval is limited to 10 milliseconds so that valid values for <code>timestamp</code> always comply to</p>
      <pre><code><code class="hljs applescript">  timestamp <span class="hljs-keyword">mod</span> <span class="hljs-number">10</span> = <span class="hljs-number">0</span></code>
      </code></pre><h3 id="-a-name-publishsubscribe-a-publish-subscribe"><a name="PublishSubscribe"></a>Publish-subscribe</h3>
      <p>In order to allow a server pushing information to a client, the WebSocket technology is used. Any client may register for events on the <code>GET</code> url of a query it is interested in to receive update by this push mechanism.</p>
      <p>There is only one WebSocket connection established per client and server port. If a client tries to open a second WebSocket connection on the same server port, the server rejects with a <code>409 Conflict</code> message. The <a href="#errorobject">ErrorObject</a> contains the following message: <code>Dude, the higlander principle applies.. I warned you.</code>. The WebSockets endpoint is the same as the regular root uri (e.g. <code>/</code> or <code>/api/v2/</code>). The same port number as for regular http requests shall be used.</p>
      <p><em>Note: WebSockets payload may get concatenated if two messages shall be sent within a frame of 50ms (according to W3C specification). Thus, payload objects always shall have a trailing ‘\n’. for client side separation.</em></p>
      <h6 id="definition">Definition</h6>
      <p>An event is considered <code>on change</code> if two subsequent GET requests on the corresponding url would result in different responses on the first level (<code>$expand=0</code>) of the response object (<code>&lt;element&gt;</code> level) or list characteristics, i.e. if an element object is added or removed from a list of objects an <code>on change</code> event is fired. In case of an <code>id</code> based <code>$offset</code>, an <code>on change</code> is fired as well, if the <a href="#pagingobject">PagingObject</a> nested in the <code>paging</code> will change its content, e.g. if the <code>offsetIndex</code> would change due to list modifications outside the list scope a client subscribed to or if the <code>total</code> changes.</p>
      <p><em>Note: This means, list subscriptions will not fire an event if the elements content changes, so if a client is interested in <code>&lt;element&gt;</code> level changes, dedicated subscriptions to each <code>&lt;element&gt;</code> of interest are needed</em></p>
      <p><strong>ATTENTION</strong> Subscriptions on levels other than <code>&lt;element&gt;</code> do only support expand level 0.</p>
      <p>An event message is defined as object serialized to JSON that is transmitted via WebSocket. The term <code>&lt;event&gt;</code> specifies the event <code>uri</code> a client wants to subscribe to, unsubscribe from, receive or emit messages for.</p>
      <p>The <code>&lt;event&gt;</code> follows the the similar syntax as a regular GET request</p>
      <pre><code><code class="hljs xml">    /<span class="hljs-tag">&lt;<span class="hljs-title">service</span>&gt;</span>/<span class="hljs-tag">&lt;<span class="hljs-title">resource</span>&gt;</span>/<span class="hljs-tag">&lt;<span class="hljs-title">element</span>&gt;</span>?<span class="hljs-tag">&lt;<span class="hljs-title">query-params</span>&gt;</span>#<span class="hljs-tag">&lt;<span class="hljs-title">uniqueid-per-session</span>&gt;</span></code>
      </code></pre><p>The known parameters (e.g. filters, paging, etc.) applicable on GET requests could be applied to subscriptions on an <code>&lt;event&gt;</code> too. This approach is reasonable for elements as well as resources.</p>
      <pre><code><code class="hljs xml">    /<span class="hljs-tag">&lt;<span class="hljs-title">service</span>&gt;</span>/<span class="hljs-tag">&lt;<span class="hljs-title">resource</span>&gt;</span>?<span class="hljs-tag">&lt;<span class="hljs-title">query-params</span>&gt;</span>#<span class="hljs-tag">&lt;<span class="hljs-title">uniqueid-per-session</span>&gt;</span></code>
      </code></pre><p>While <code>/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;</code> describes the actual event <code>uri</code>, or <code>/&lt;service&gt;/&lt;resource&gt;/</code> describes the resource name, the <code>&lt;uniqueid-per-session&gt;</code> parameter allows multiple subscription for the same event with different fields of interest, update rate or updatelimit on client side. Therefore an <em>optional</em> <code>&lt;uniqueid-per-session&gt;</code> is generated on client side. The server does not care about the <code>&lt;uniqueid-per-session&gt;</code> as it is pure client side information. The server <strong>must not</strong> alter or remove <code>&lt;uniqueid-per-session&gt;</code> from the event uri. The <em>optional</em> <code>&lt;query-params&gt;</code> section of the subscription contains the <code>GET</code> parameters, a regular <code>GET</code> query would have in polling mode.</p>
      <p>There are two mandatory properties for every message sent via WebSocket that are <code>type</code> and <code>uri</code> (=event). The first describes the intention (e.g. ‘subscribe’) of the message sent, while the later identifies the endpoint itself.</p>
      <h4 id="subscribe">Subscribe</h4>
      <p>To subscribe to an <code>&lt;event&gt;</code>, the client has to send the following JSON stringified object to the server:</p>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">type</span>" : <span class="hljs-value"><span class="hljs-string">"subscribe"</span></span>,
        "<span class="hljs-attribute">event</span>" : <span class="hljs-value"><span class="hljs-string">"/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;?&lt;query-params&gt;#&lt;uniqueid-per-session&gt;"</span></span>,
        "<span class="hljs-attribute">interval</span>": <span class="hljs-value">&lt;timeStepInMs&gt;</span>,
        "<span class="hljs-attribute">updatelimit</span>": <span class="hljs-value">&lt;timeStepInMs&gt;</span>,
        "<span class="hljs-attribute">authorization</span>": <span class="hljs-value">&lt;token&gt;</span>,
        "<span class="hljs-attribute">autosubscribe</span>": <span class="hljs-value">&lt;<span class="hljs-literal">true</span>|<span class="hljs-literal">false</span>&gt;
      </span>}</code>
      </code></pre>
      <p>The fields a client is interested in and also the number of items defined by <code>$offset</code> and <code>$limit</code> parameters have to be send in the <em>optional</em> <code>&lt;query-params&gt;</code> section of the subscription. In case a client subscribes with  <code>$offset</code> and <code>$limit</code> set, a list window is subscribed.</p>
      <p>The response to a <code>subscribe</code> must follow the structure if it succeeded or trigger an <a href="#subscriptionerror">error message</a> if it fails:</p>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">type</span>" : <span class="hljs-value"><span class="hljs-string">"subscribe"</span></span>,
        "<span class="hljs-attribute">event</span>" : <span class="hljs-value"><span class="hljs-string">"/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;?&lt;query-params&gt;#&lt;uniqueid-per-session&gt;"</span></span>,
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span>
      </span>}</code>
      </code></pre>
      <h4 id="filtering">Filtering</h4>
      <p>The subscription takes an optional list of <code>&lt;attrName&gt;</code> strings named <em>fields</em> that specify the attributes the client wants to subscribe to.</p>
      <h5 id="periodic">Periodic</h5>
      <p>The optional <em>interval</em> attribute specifies the update frequency in milliseconds for periodic updates, while the optional <em>updatelimit</em> attribute specifies the maximum update rate in milliseconds for ‘on change’ notification. If <em>interval</em> is set, <em>updatelimit</em> is always overruled.</p>
      <h5 id="on-change">On change</h5>
      <p>If <em>interval</em> is not set, the notification interval is defined ‘on change’ and can be limited by specifying an <em>updatelimit</em>. If an ‘on change’ occours before <em>updatelimit</em> elapsed, an event will be sent as soon as <em>updatelimit</em> elapsed. If there are multiple changes before the next possible update, only the last one know state is sent after <em>updatelimit</em> elapsed.</p>
      <h5 id="automatic-subscription">Automatic subscription</h5>
      <p>If <em>autosubscribe</em> is set as true while requesting subscription on resource level, the server will additionally subscribe the client as listener for all elements as well. Furthermore, the server is responsible for maintaining subscriptions, i.e. removing subscriptions for vanished elements, and adding subscriptions for new elements. This is a convenience mechanism used to avoid traffic when a client needs to watch a list of elements.</p>
      <p>In case a client subscribes with  <code>$offset</code> and <code>$limit</code> set, only the elements of the requested list window are additionally subscribed.</p>
      <h4 id="unsubscribe">Unsubscribe</h4>
      <p>To unsubscribe an <code>event</code>, the client has to send the following JSON-serialized object to the server, regardless of the query parameters<code>?&lt;query-params&gt;</code> used to subscribe:</p>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">type</span>" : <span class="hljs-value"><span class="hljs-string">"unsubscribe"</span></span>,
        "<span class="hljs-attribute">event</span>" : <span class="hljs-value"><span class="hljs-string">"/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;#&lt;uniqueid-per-session&gt;"</span></span>,
        "<span class="hljs-attribute">autosubscribe</span>": <span class="hljs-value">&lt;<span class="hljs-literal">true</span>|<span class="hljs-literal">false</span>&gt;
      </span>}</code>
      </code></pre>
      <h5 id="automatic-unsubscription">Automatic unsubscription</h5>
      <p>If <em>autosubscribe</em> is set as true while requesting unsubscription on resource level, the server will additionally unsubscribe the client as listener for all elements as well.</p>
      <p>In case a client unsubscribes with  <code>$offset</code> and <code>$limit</code> set, only the elements of the requested list window are additionally unsubscribed.</p>
      <h4 id="reauthorize">reauthorize</h4>
      <p>In case of expiring access tokens (cmp. <a href="#userauth">authorization</a>), a subscription has to be re-authorizable.
      To reauthorize a subscription for an <code>&lt;event&gt;</code>, the client has to send the following JSON stringified object to the server:</p>
      <pre><code class="lang-javascript"><code class="hljs javascript">{
        <span class="hljs-string">"type"</span> : <span class="hljs-string">"reauthorize"</span>,
        <span class="hljs-string">"event"</span> : <span class="hljs-string">"/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;?&lt;query-params&gt;#&lt;uniqueid-per-session&gt;"</span>,
        <span class="hljs-string">"authorization"</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">token</span>&gt;</span>
      }</span></code>
      </code></pre>
      <p>The subscription parameters do not change with <code>reauthorize</code>. The client will receive the same fields, with the same rates as for the original subscription.</p>
      <p>The response to a <code>reauthorize</code> must follow the structure if it succeeded or trigger an error message if it fails:</p>
      <pre><code class="lang-javascript"><code class="hljs javascript">{
        <span class="hljs-string">"type"</span> : <span class="hljs-string">"reauthorize"</span>,
        <span class="hljs-string">"event"</span> : <span class="hljs-string">"/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;?&lt;query-params&gt;#&lt;uniqueid-per-session&gt;"</span>,
        <span class="hljs-string">"status"</span> : <span class="hljs-string">"ok"</span>
      }</code>
      </code></pre>
      <h4 id="data">Data</h4>
      <p>For now, only the server is able to emit <code>data</code> events. The emitted data is expected to be a JSON formatted object:</p>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">type</span>" : <span class="hljs-value"><span class="hljs-string">"data"</span></span>,
        "<span class="hljs-attribute">event</span>" : <span class="hljs-value"><span class="hljs-string">"/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;?&lt;query-params&gt;#&lt;uniqueid-per-session&gt;"</span></span>,
        "<span class="hljs-attribute">data</span>": <span class="hljs-value">&lt;payload&gt;</span>,
        "<span class="hljs-attribute">timestamp</span>": <span class="hljs-value">Integer
      </span>}</code>
      </code></pre>
      <p>or for subscriptions to collections</p>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">type</span>" : <span class="hljs-value"><span class="hljs-string">"data"</span></span>,
        "<span class="hljs-attribute">event</span>" : <span class="hljs-value"><span class="hljs-string">"/&lt;service&gt;/&lt;resource&gt;/?&lt;query-params&gt;#&lt;uniqueid-per-session&gt;"</span></span>,
        "<span class="hljs-attribute">data</span>": <span class="hljs-value">&lt;payload&gt;</span>,
        "<span class="hljs-attribute">paging</span>" : <span class="hljs-value">&lt;pagingObject&gt;</span>,
        "<span class="hljs-attribute">timestamp</span>": <span class="hljs-value">Integer
      </span>}</code>
      </code></pre>
      <p>The <code>&lt;payload&gt;</code> is defined per event. The server manages the event distribution for all connected clients as defined above, i.e. parsing the event and transmitting it to all registered clients with the expected timing and filtering applied.</p>
      <h4 id="-a-name-subscriptionerror-a-error"><a name="subscriptionerror"></a> Error</h4>
      <p>If any error on the server side occurs an object with type ‘error’ is sent. The following JSON format shall be used:</p>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">type</span>" : <span class="hljs-value"><span class="hljs-string">"error"</span></span>,
        "<span class="hljs-attribute">code</span>": <span class="hljs-value">&lt;identifier&gt;</span>,
        "<span class="hljs-attribute">event</span>": <span class="hljs-value">/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;#&lt;uniqueid-per-session&gt;</span>,
        "<span class="hljs-attribute">message</span>": <span class="hljs-value">&lt;errormessage&gt;
      </span>}</code>
      </code></pre>
      <p>The content in <code>&lt;errormessage&gt;</code> must be a describing string for the error, while code contains an identifier from the error codes table.</p>
      <p><strong>Note</strong>: The request leading to this error is NOT processed, i.e. neither subscription, nor unsubscription is processed!</p>
      <p>In case of an error during subscription, an immediate response (e.g. code 403) is sent.</p>
      <h5 id="element-gone">Element gone</h5>
      <p>Assuming that a subscription to a specific element exists (i.e. <code>/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;</code>), a <code>410</code> error shall be sent if the element vanishes for any reason.</p>
      <h5 id="forbidden-access">Forbidden access</h5>
      <p>Assuming that a subscription to a specific element (i.e. <code>/&lt;service&gt;/&lt;resource&gt;/&lt;element&gt;</code>) or resource (i.e. <code>/&lt;service&gt;/&lt;resource&gt;/</code>) exists, a <code>403</code> error shall be sent if access is restricted for any reason (e.g. expired token or insufficient rights).</p>
      <h4 id="multi-client-behavior">Multi client behavior</h4>
      <p>The system and therefore the API is designed to be multi client capable. If two clients send subsequent requests to the server, there is no guaranty that a client achieves the desired system state. E.g. Client A sends a request to tune to a frequency X, Client B may send a request to tune to frequency Y just before tuning to frequency X is finished and clients are notified. The final state will be ‘tuned to frequency Y’.
      The system works in a <a href="https://en.wikipedia.org/wiki/FIFO_%28computing_and_electronics%29">FIFO</a> fashion, not considering latencies in communicating to different clients. To avoid race conditions, clients MUST not force the system to desired state by any kind of cheating like continuous requesting.</p>
      <h4 id="initial-data-response">Initial data response</h4>
      <p>Immediately after sending the subscription response, a server shall send the first data message, to avoid race conditions by handing multiple clients. This leads to the messaging sequence shown below:</p>
      <p><img src="img/diagram2.png" alt="avoid race conditions"></p>
      <p>When using <em>autosubscribe</em> on resource level, the server will also send initial data messages for all elements that were automatically subscribed. The same holds true for new elements when automatic subscription is enabled.</p>
      <h4 id="lifecycle">Lifecycle</h4>
      <p>All subscription are strictly bound to the WebSocket connection, if the connection is lost or is terminated in a regular way, subscription become invalid. The client listening for events has to resubscribe.</p>
      <h3 id="error-codes">Error codes</h3>
      <p>The following regular HTTP error codes have a specific interpretation in the subscription context. The codes are be transferred within the JSON response, not on HTTP level for subscriptions.</p>
      <table>
        <thead>
          <tr>
            <th>code</th>
            <th>meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>400</td>
            <td>syntax error</td>
          </tr>
          <tr>
            <td>403</td>
            <td>access denied (token invalid or expired)</td>
          </tr>
          <tr>
            <td>404</td>
            <td>subscription uri invalid</td>
          </tr>
          <tr>
            <td>503</td>
            <td>maximum number of event subscriptions reached</td>
          </tr>
        </tbody>
      </table>
      <h3 id="security">Security</h3>
      <p>All information exchanged between any client and server in the network shall be secured by using https and wss protocols. The <a href="#exploration">exploration</a> feature (1.14) has to be limited to only the endpoints that a client is authorized to access (e.g. public endpoints).</p>
      <p>There are different well known methods of authentication for web interfaces such as certificate exchange between client and server, username/password exchange or identifier/token transmission <a href="#userauth">Authorization &amp; Authentication</a>.</p>
      <p>To expose the API to clients with limited access to those APIs, a user and privileges management service is designed. The details of this process are described in a dedicated section <a href="#service_registry">service registry</a>.</p>
      <p>In general, a client registers itself as user with the system. To obtain privileges for a certain <code>&lt;service&gt;</code> or <code>&lt;resource&gt;</code>, a client has to <code>POST</code> a request. There will be a master client that has administrative rights, e.g. the main unit UI, that can can grant or deny the privileges request based on the information provided with the request.</p>
      <h3 id="rest-is-not-rpc">REST is not RPC</h3>
      <p>While RPC APIs expose procedures to perform the necessary steps to get from one state to another on the servers side, the REST API has to be understood in a OO (object oriented) way. The server is providing an interface to its objects/models. The client requests changes of the servers models/objects properties.</p>
      <p>There is no mechanism defined to use RPC via the interfaces described in here for a reason. There is no need to, because the server models/objects are defined accordingly.</p>
      <h3 id="-a-name-exploration-a-exploration"><a name="exploration"></a>Exploration</h3>
      <p>The server provides access its own interfaces by an explore mechanism via GET.</p>
      <p>The client can start exploring a server from its root (e.g. <code>/</code>or <code>/api/v2/</code>) endpoint, which returns a list of available
      services represented as <a href="#serviceObject">serviceObjects</a>..</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/api/v2/</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip, deflate, sdch</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">X-Powered-By</span>: <span class="hljs-string">Express</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">ETag</span>: <span class="hljs-string">"-32550834"</span>
      <span class="hljs-attribute">Content-Encoding</span>: <span class="hljs-string">gzip</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Thu, 04 Dec 2015 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
      "<span class="hljs-attribute">status</span>": <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
      "<span class="hljs-attribute">data</span>": <span class="hljs-value">[
        &lt;serviceObject&gt;,
        ...,
        &lt;serviceObject&gt;
        ]
      </span>}</span></code>
      </code></pre><p>Querying the next level <code>/&lt;service&gt;/</code> - please note the trailing <code>/</code>for a list query - returns a list of available resources of the service. </p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/api/v2/&lt;service&gt;/</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json</span>
      <span class="hljs-attribute">Accept-Encoding</span>: <span class="hljs-string">gzip, deflate, sdch</span>
      <span class="hljs-attribute">Accept-Language</span>: <span class="hljs-string">en-US,en;q=0.8,de;q=0.6</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Thu, 04 Dec 2015 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="clojure">
      <span class="hljs-collection">{
      <span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>,
      <span class="hljs-string">"data"</span>: <span class="hljs-collection">[
          <span class="hljs-collection">{
            <span class="hljs-string">"id"</span>: &lt;uui&gt;,
            <span class="hljs-string">"name"</span>: &lt;string&gt;,
            <span class="hljs-string">"uri"</span>: &lt;string<span class="hljs-list">(<span class="hljs-keyword">uri</span>)</span>&gt;,
            <span class="hljs-string">"description"</span>: &lt;detailled description of the resource&gt;,
          }</span>,
          <span class="hljs-collection">{
            ...
          }</span>
        ]</span>
      }</span></span></code>
      </code></pre><p>Finally a resource will list all of its elements under <code>/&lt;service&gt;/&lt;resource&gt;/</code> - find examples in the <a href="#expansion_concept">Expansion</a> section.</p>
      <h4 id="reserved-keywords">Reserved keywords</h4>
      <p>The protocol knows dedicated keywords that are described below.</p>
      <h5 id="-accessrights">$accessrights</h5>
      <p>A query on service level that contains the <em>$accessrights</em> keyword (<code>/&lt;service&gt;/$accessrights/</code>) will return a description of the privileges the querying client has. 
      Every entry describes one access right for the given path. 
      The given response describes these privileges according to the given JSON schema:</p>
      <pre><code><code class="hljs json">{
        "<span class="hljs-attribute">$schema</span>": <span class="hljs-value"><span class="hljs-string">"http://json-schema.org/draft-06/schema#"</span></span>,
        "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"object"</span></span>,
        "<span class="hljs-attribute">patternProperties</span>": <span class="hljs-value">{
        "<span class="hljs-attribute">^\/[a-z0-9_]+(\/[A-Za-z0-9_]+)?\/$</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"array"</span></span>,
          "<span class="hljs-attribute">items</span>": <span class="hljs-value">{
           "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
            "<span class="hljs-attribute">enum</span>": <span class="hljs-value">[
              <span class="hljs-string">"create"</span>,
              <span class="hljs-string">"read"</span>,
              <span class="hljs-string">"update"</span>,
              <span class="hljs-string">"delete"</span>
              ]
            </span>}
          </span>}
        </span>}</span>,
        "<span class="hljs-attribute">additionalProperties</span>": <span class="hljs-value"><span class="hljs-literal">false</span>
      </span>}</code>
      </code></pre><p>Example: Request priveleges for the connecting client for media</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/media?accessrights</span> HTTP/1.1</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json;q=0.8</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      
      <span class="json">
      {
          "<span class="hljs-attribute">/media/titles/</span>": <span class="hljs-value">[ <span class="hljs-string">"create"</span> ]</span>,
          "<span class="hljs-attribute">/media/artists/</span>": <span class="hljs-value">[<span class="hljs-string">"create"</span>, <span class="hljs-string">"update"</span>]</span>,
          "<span class="hljs-attribute">/media/</span>": <span class="hljs-value">[<span class="hljs-string">"read"</span>]
      </span>}</span></code>
      </code></pre><h5 id="-id">$id</h5>
      <p>A query that contains the <em>$id</em> keyword on any level will return a plain string, the <code>id</code>. In the case of a request on root level, the id is a unique identifier for the system. On all other levels, the id of the element of interest will be return in the same plain way - note the Accept header being set to <code>text/plain</code>.</p>
      <p>Example: Request the system id</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/$id</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">text/plain</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">text/plain; charset=utf-8</span>
      
      <span class="cpp">
      d2cb3c92-ad8f-<span class="hljs-number">496f</span>-b463-<span class="hljs-number">7</span>a86973c677a</span></code>
      </code></pre><p>Example: Request a <code>&lt;service&gt;</code>s id</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/&lt;service&gt;$id</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">text/plain</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">text/plain; charset=utf-8</span>
      
      <span class="autohotkey">
      <span class="hljs-number">864</span>d79f9-a1ea-<span class="hljs-number">405</span><span class="hljs-literal">a</span>-<span class="hljs-number">82</span>a3-<span class="hljs-number">2</span>a62c3745f25</span></code>
      </code></pre><h5 id="-spec">$spec</h5>
      <p>A query that contains the <em>$spec</em> keyword like <code>/&lt;service&gt;/$spec</code> will return a schema of the resources interface according to the viwi schema specification (refer to the actual viwi object definition). The resource describes its own object shape this way.</p>
      <p>Example: Request a service's schema</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">GET <span class="hljs-string">/media/$spec</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json;q=0.8</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      
      <span class="json">
      {
          "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"viwi.service.media"</span></span>,
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">""</span></span>,
          "<span class="hljs-attribute">resources</span>": <span class="hljs-value">{
              "<span class="hljs-attribute">collections</span>": <span class="hljs-value">{
                  "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"The media collections can also be understood as media queues of the renderer. Media collections can only contain playable media like tracks, videos or pictures."</span></span>,
                  "<span class="hljs-attribute">model</span>": <span class="hljs-value">{
                      "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"mediaCollectionObject"</span></span>,
                      "<span class="hljs-attribute">resource</span>": <span class="hljs-value"><span class="hljs-string">"media.collections"</span></span>,
                      "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{
                          "<span class="hljs-attribute">id</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"collection id"</span></span>,
                              "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
                              "<span class="hljs-attribute">format</span>": <span class="hljs-value"><span class="hljs-string">"uuid"</span>
                          </span>}</span>,
                          "<span class="hljs-attribute">name</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"collection name"</span></span>,
                              "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span>
                          </span>}</span>,
                          "<span class="hljs-attribute">uri</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"object uri"</span></span>,
                              "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
                              "<span class="hljs-attribute">format</span>": <span class="hljs-value"><span class="hljs-string">"uri"</span>
                          </span>}
                      </span>}
                  </span>}</span>,
                  "<span class="hljs-attribute">endpoints</span>": <span class="hljs-value">{
                      "<span class="hljs-attribute">resource</span>": <span class="hljs-value">{
                          "<span class="hljs-attribute">get</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">parameters</span>": <span class="hljs-value">{}
                          </span>}
                      </span>}</span>,
                      "<span class="hljs-attribute">element</span>": <span class="hljs-value">{
                          "<span class="hljs-attribute">get</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">parameters</span>": <span class="hljs-value">{}
                          </span>}</span>,
                          "<span class="hljs-attribute">delete</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">parameters</span>": <span class="hljs-value">{}
                          </span>}
                      </span>}
                  </span>}
              </span>}</span>,
              "<span class="hljs-attribute">renderers</span>": <span class="hljs-value">{
                  "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"The media player renderer can be understood as the actual media player. It accepts media objects and applies actions like play, pause etc. to them."</span></span>,
                  "<span class="hljs-attribute">model</span>": <span class="hljs-value">{
                      "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"rendererObject"</span></span>,
                      "<span class="hljs-attribute">resource</span>": <span class="hljs-value"><span class="hljs-string">"media.renderers"</span></span>,
                      "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{
                          "<span class="hljs-attribute">id</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"renderer id"</span></span>,
                              "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
                              "<span class="hljs-attribute">format</span>": <span class="hljs-value"><span class="hljs-string">"uuid"</span>
                          </span>}</span>,
                          "<span class="hljs-attribute">name</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"renderer name"</span></span>,
                              "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span>
                          </span>}</span>,
                          "<span class="hljs-attribute">uri</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"object uri"</span></span>,
                              "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
                              "<span class="hljs-attribute">format</span>": <span class="hljs-value"><span class="hljs-string">"uri"</span>
                          </span>}</span>,
                          "<span class="hljs-attribute">type</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"type of medium"</span></span>,
                              "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
                              "<span class="hljs-attribute">enum</span>": <span class="hljs-value">[
                                  <span class="hljs-string">"track"</span>,
                                  <span class="hljs-string">"video"</span>,
                                  <span class="hljs-string">"image"</span>
                              ]
                          </span>}
                      </span>}
                  </span>}</span>,
                  "<span class="hljs-attribute">endpoints</span>": <span class="hljs-value">{
                      "<span class="hljs-attribute">resource</span>": <span class="hljs-value">{
                          "<span class="hljs-attribute">get</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">parameters</span>": <span class="hljs-value">{}
                          </span>}
                      </span>}</span>,
                      "<span class="hljs-attribute">element</span>": <span class="hljs-value">{
                          "<span class="hljs-attribute">get</span>": <span class="hljs-value">{
                              "<span class="hljs-attribute">parameters</span>": <span class="hljs-value">{}
                          </span>}
                      </span>}
                  </span>}</span>,
                  "<span class="hljs-attribute">systemTriggeredEvents</span>": <span class="hljs-value">[
                      <span class="hljs-string">"element"</span>,
                      <span class="hljs-string">"resource"</span>
                  ]
              </span>}
          </span>}
      </span>}</span></code>
      </code></pre><h2 id="-a-name-globaljsonobjects-a-global-json-objects"><a name="GlobalJSONobjects"></a> Global JSON objects</h2>
      <h3 id="general">General</h3>
      <p>General object structures are introduced below. All keys in request and response (including event payload) JSON have to be treated with regard of their casing (case sensitive), to avoid conflicts reading or writing values from or to a JSON object. E.g. the property name <code>RouteCalculationProgress</code> is different to <code>routecalculationprogress</code>.</p>
      <h4 id="-a-name-xobject-a-xobject"><a name="XObject"></a>XObject</h4>
      <h5 id="mandatory-properties">Mandatory properties</h5>
      <p>The XObject is the general object used to derive all detailed objects from. Thus, every object exchanged through the API defined inhere has at least all XObject properties (mandatory). Optional properties for any object are only sent if applicable. A missing property is treated as being <code>undefined</code> and thus not processable for the client.</p>
      <table>
        <thead>
          <tr>
            <th>Property</th>
            <th>Description</th>
            <th>Type</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>id</td>
            <td>identifier</td>
            <td>uuid</td>
          </tr>
          <tr>
            <td>name</td>
            <td>object name</td>
            <td>String</td>
          </tr>
          <tr>
            <td>uri</td>
            <td>object uri</td>
            <td>URI</td>
          </tr>
        </tbody>
      </table>
      <p>The <code>uri</code> of an XObject can be either relative or absolute. If the XObject refers to an element available on the same host and port, the <code>uri</code> has to be relative, else if the referred element is stored on a different host or port, the <code>uri</code> must be absolute, to keep the amount of redundant data and thus traffic at a minimum.</p>
      <h5 id="types-for-xobject-properties">Types for XObject properties</h5>
      <p>The properties of a XObject can be of one of the following types:</p>
      <ul>
      <li>primitives like 'boolean', 'integer', 'number', 'string', 'enum'</li>
      <li>complex types, treated like primitives</li>
      <li>references to other XObjects</li>
      <li>arrays of one of the other types</li>
      </ul>
      <h5 id="complex-types">Complex types</h5>
      <p>A complex type is a kind of named inline object that is not a XObject and therefore can not be addressed or referenced by it's own 'uri' and thus has no mandatory properties. It's comparable to structs in C programming language and may contain primitives, complex types, references to XObjects and arrays of those. Complex types can be reused in multiple XObject or other complex type definitions once specified.</p>
      <h4 id="-a-name-statusobject-a-statusobject"><a name="statusobject"></a> StatusObject</h4>
      <p>A StatusObject is a general object without data (payload) attribute. For HTTP response code 201 (Created), the HTTP header ‘Location’ is the one of the new element which was created by the request (<a href="https://www.ietf.org/rfc/rfc2616.txt">HTTP/1.1 status codes, 2012, RFC2616</a>). Possible StatusObjects are shown below:</p>
      <h5 id="ok">OK</h5>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span>
      </span>}</code>
      </code></pre>
      <h5 id="-a-name-errorobject-a-error"><a name="errorobject"></a>Error</h5>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"error"</span></span>,
        "<span class="hljs-attribute">message</span>": <span class="hljs-value">&lt;String&gt;</span>,
        "<span class="hljs-attribute">code</span>": <span class="hljs-value">&lt;identifier&gt;
      </span>}</code>
      </code></pre>
      <h4 id="-a-name-pagingobject-a-pagingobject"><a name="pagingobject"></a> PagingObject</h4>
      <p>In case of paged data response, the <code>paging</code> property contains the <code>previous</code>and <code>next</code> pages a client can query. If the data does not have a <code>previous</code> or <code>next</code> page, the corresponding property will be undefined. Lists are linear, i.e. the first page has no predecessor, the last page has no successor.</p>
      <p>In addition to those pointers, <code>total</code> and <code>totalPages</code> are defined to represent the <code>total</code> number of items available on the server and the number of <code>totalPages</code> resulting in chunking them in <code>$limit</code>elements per page. In case of unknown or uncountable items, the properties might be undefined. If the data does not have a <code>previous</code> or <code>next</code> page, the corresponding property will be undefined.</p>
      <p>The <code>$offset</code> is returned with the repsonse in two ways, <code>offsetId</code> expresses the offset as number, <code>offsetIndex</code> expresses the offset as elements uuid, regardless of the type of the query, i.e. independently from wether an id or an numeric <code>$offset</code>was used in the request.</p>
      <p>The general structure of an paging object is described as follows</p>
      <pre><code class="lang-javascript"><code class="hljs javascript">{
        <span class="hljs-string">"offsetId"</span>: <span class="hljs-built_in">String</span>,       <span class="hljs-comment">// offset expressed as element id (uuid)</span>
        <span class="hljs-string">"offset"</span>: Integer,        <span class="hljs-comment">// offset expressed as index (numeric)</span>
        <span class="hljs-string">"total"</span>: Integer,         <span class="hljs-comment">// total number of elements</span>
        <span class="hljs-string">"totalPages"</span>: Integer,    <span class="hljs-comment">// total number of pages based on limit</span>
        <span class="hljs-string">"previous"</span>: <span class="hljs-built_in">String</span>,       <span class="hljs-comment">// link to previous page</span>
        <span class="hljs-string">"next"</span>: <span class="hljs-built_in">String</span>,           <span class="hljs-comment">// link to next page</span>
        <span class="hljs-string">"limit"</span>: Integer          <span class="hljs-comment">// the limit used</span>
      }</code>
      </code></pre>
      <p>A query with <code>?$limit=0</code> (ref. <a href="#paging">Paging</a>) gets the total number of items without actually retrieving a list of items in <code>data</code>, which will be an empty list.</p>
      <p>request:</p>
      <pre><code><code class="hljs stata">  GET medialibrary/albums?<span class="hljs-label">$limit</span>=0 HTTP/1.1
        Host: 127.0.0.1:1337
        Accept: application/json
        Accept-Encoding: gzip,deflate
        Accept-Language: <span class="hljs-keyword">en</span>-<span class="hljs-keyword">US</span>,<span class="hljs-keyword">en</span>;q=0.8,<span class="hljs-keyword">de</span>;q=0.6</code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Vary</span>: <span class="hljs-string">Accept-Encoding</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 13 Jun 2014 19:47:27 GMT</span>
      <span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>
      <span class="hljs-attribute">Transfer-Encoding</span>: <span class="hljs-string">chunked</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>": <span class="hljs-value">[]</span>,
        "<span class="hljs-attribute">paging</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">total</span>": <span class="hljs-value"><span class="hljs-number">314159</span>
        </span>}
      </span>}</span></code>
      </code></pre><h4 id="-a-name-responseobject-a-responseobject"><a name="responseobject"></a>ResponseObject</h4>
      <p>All viwi objects are JSON (objects), that are encapsulated in a general response structure, except binary data such as images, videos etc.. This response structure is different between HTTP payload and <a href="#PublishSubscribe">Publish-Subscribe</a> messages, while the <code>data</code> property in both cases is identical and is considered being the actual <em>payload</em>. If a request was successfully processed (HTTP 200), an object in the following notation is returned:</p>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>": <span class="hljs-value">&lt;Response&gt;</span>,
        "<span class="hljs-attribute">paging</span>" : <span class="hljs-value">&lt;PagingObject&gt;</span>,
        "<span class="hljs-attribute">timestamp</span>": <span class="hljs-value">Integer
      </span>}</code>
      </code></pre>
      <p>In case of paged data response, the <code>paging</code> property contains the  <a href="#pagingobject"><code>PagingObject</code></a> described above. Of course, paging only applies to <code>/&lt;service&gt;/&lt;resource&gt;/</code> queries.</p>
      <p>The <code>&lt;response&gt;</code> contains the actual JSON payload that is defined separately for each REST endpoint. If a request failed, status is set to <code>error</code> and <a href="#errorobject"><code>ErrorObject</code></a> is sent.</p>
      <p>For responses on <code>&lt;service&gt;</code> level (e.g. <code>/api/v1/myService</code> - note the missing trailing <code>/</code> for an element like accesss), a ResponseObject contains an additional <code>service</code> field to represent itself as a <a href="#serviceObject">serviceObject</a>:</p>
      <pre><code class="lang-json"><code class="hljs json">{
        "<span class="hljs-attribute">status</span>" : <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
        "<span class="hljs-attribute">data</span>": <span class="hljs-value">&lt;Response&gt;</span>,
        "<span class="hljs-attribute">paging</span>" : <span class="hljs-value">&lt;pagingObject&gt;</span>,
        "<span class="hljs-attribute">timestamp</span>": <span class="hljs-value">Integer</span>,
        "<span class="hljs-attribute">service</span>": <span class="hljs-value">&lt;serviceObject&gt;
      </span>}</code>
      </code></pre>
      <h3 id="binary-content">binary content</h3>
      <p>There are endpoints like the cdn service that delivery binary data. This data is transmitted with regular HTTP headers according to its MIME-type. Subscription on binary data like images, video, certificates etc. is not possible. Binary data is considered being <code>static</code>.</p>
      <h3 id="schema">Schema</h3>
      <p>All object properties make use JSON Schema definitions <a href="https://tools.ietf.org/html/rfc7159">RFC7159</a>. In addition to the formats defined in RFC7159 the <code>date-time</code>, <code>date</code> and <code>time</code> formats are derived but not identical to the definition in <a href="https://tools.ietf.org/html/rfc3339">RFC3339</a>. APIs may also use the following (proprietary) formats:</p>
      <pre><code><code class="hljs json">{
        "<span class="hljs-attribute">uuid</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"unique identifier"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"388d3a25-663b-11e3-949a-0800200c9a66"</span>
        </span>}</span>,
        "<span class="hljs-attribute">geoposition</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"latitude followed by longitude and altitude in meters separated by ';'"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^[-+]?[0-9]*\.?[0-9]*;[-+]?[0-9]*\.?[0-9]*;[-+]?[0-9]*\.?[0-9]*$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"37.772323;-122.214897;0"</span>
        </span>}</span>,
        "<span class="hljs-attribute">e164telephonenumber</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"E.164 encoded Telephone number"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^\+?\d{4,23}$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"+49536190"</span>
        </span>}</span>,
        "<span class="hljs-attribute">macaddress</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"device mac address"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^([0-9A-F]{2}[:-]){5}([0-9A-F]{2})$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"a3:3E:ff:e3:01:fe"</span>
        </span>}</span>,
        "<span class="hljs-attribute">rgba</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"rgba color with alpha"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*(\d(?:\.\d+)?))?\)$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"rgba(25,9,19,0.4)"</span>
        </span>}</span>,
        "<span class="hljs-attribute">language</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"HTTP1.1 compatible language tag"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^(\w{2})(-\w*)?$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"en-gb"</span>
        </span>}</span>,
        "<span class="hljs-attribute">servicecategory</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"plain string category name"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^[a-z]*$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"car"</span>
        </span>}</span>,
        "<span class="hljs-attribute">duration</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"iso8601 duration"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^P\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"P0003-06-04T12:30:05"</span>
        </span>}</span>,
        "<span class="hljs-attribute">temperatureUnit</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"temperature measurement unit"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^[KCF]{1}$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"C"</span>
        </span>}</span>,
        "<span class="hljs-attribute">distanceUnit</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"distance unit"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^mi|km|yd|m|ft$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"km"</span>
        </span>}</span>,
        "<span class="hljs-attribute">pressureUnit</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"pressure measurement unit"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^bar|psi|kPa$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"bar"</span>
        </span>}</span>,
        "<span class="hljs-attribute">volumeUnit</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"volume measurement unit (ul = microliter, us.dry.gal = dry US gallon, us.liq.gal = liquid US gallon, imp.gal = imperial gallon)"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^l|ml|ul|us.liq.gal|us.dry.gal|imp.gal$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"ml"</span>
        </span>}</span>,
        "<span class="hljs-attribute">consumptionUnit</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"consumption measurement unit (fluid, gas, electric)"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^l/100km|l/h|km/l|mpgUS|mpgUK|g/h|kg/100km|km/kg|kg/h|m3/100km|km/m3|m3/h|miles/lbs|lbs/h|miles/yard3|yard3/h|miles/kg|miles/m3|kWh/100km|km/kWh|kWh/100miles|miles/kWh|kW|Ws|miles/gal_eqUS$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"l/h"</span>
        </span>}</span>,
        "<span class="hljs-attribute">weightUnit</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"consumption measurement unit (fluid, gas, electric)"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^t|kg|g|mg|lbs$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"kg"</span>
        </span>}</span>,
        "<span class="hljs-attribute">speedUnit</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"speed unit"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^kmh|mph|m/s$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"kmh"</span>
        </span>}</span>,
        "<span class="hljs-attribute">timeFormat</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"the time format for clocks"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^12h|24h$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"12h"</span>
        </span>}</span>,
        "<span class="hljs-attribute">dateFormat</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"date format"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^ddmmyyyy|mmddyyyy|yyyymmdd$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"mmddyyyy"</span>
        </span>}</span>,
        "<span class="hljs-attribute">date-time</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"date-time (based on RFC3339 5.6) detailed fraction"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?((Z|(\+|\-)\d{2}:\d{2}))$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"2005-11-12T12:01:42.123+01:00"</span>
        </span>}</span>,
        "<span class="hljs-attribute">time</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"time (based on RFC3339 5.6) detailed fraction"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^\d{2}:\d{2}:\d{2}(\.\d{3})?((Z|(\+|\-)\d{2}:\d{2}))$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"12:01:42.123+01:00"</span>
        </span>}</span>,
        "<span class="hljs-attribute">date</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"date (RFC3339 5.6)"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^\d{4}-\d{2}-\d{2}$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"2005-11-12"</span>
        </span>}</span>,
        "<span class="hljs-attribute">uri</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"uri with schema http(s) or w/o Authority"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"(https?:(\/\/([a-z0-9\-._~%]+|\[[a-f0-9:.]+\])(:[0-9]+)?))?(\/[a-zA-Z0-9\-._~%!&amp;\$'()*+,;=:@]+)*\/?(\?[a-zA-Z0-9\-._~%!&amp;\$'()*+,;=:@\/?]*)?(\#[a-zA-Z0-9\-._~%!&amp;\$'()*+,;=:@\/?]*)?"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"http://www.example.com/aDocument?foo#bar"</span>
        </span>}</span>,
        "<span class="hljs-attribute">ical</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>":<span class="hljs-value"><span class="hljs-string">"iCal format defined in https://tools.ietf.org/html/rfc5545"</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^BEGIN:VCALENDAR[\S\s]+END:VCALENDAR$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"BEGIN:VCALENDAR  END:VCALENDAR"</span>
        </span>}</span>,
        "<span class="hljs-attribute">point2D</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"The coordinates of a point, where “0;0” is the upper left corner of the coordinate system."</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^\d{6};\d{6}$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"300;200"</span>
        </span>}</span>,
        "<span class="hljs-attribute">rectangle2D</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"The description of a rectangle. The first two values describe the upper left corner of the rectangle, where “0;0” is the upper left corner of the coordinate system. Value 3 describes the width, value 4 the height of the rectangle."</span></span>,
          "<span class="hljs-attribute">regex</span>": <span class="hljs-value"><span class="hljs-string">"^\d{6};\d{6};\d{6};\d{6}$"</span></span>,
          "<span class="hljs-attribute">example</span>": <span class="hljs-value"><span class="hljs-string">"0;0;1280;640"</span>
        </span>}
      </span>}</code>
      </code></pre><p>It is also allowed to define a dedicated regular expression pattern as format on property definition level.</p>
      <h4 id="number-vs-integer">number vs integer</h4>
      <p>JSON does not allow non-numbers like <code>NaN</code>, nor does it make any distinction between integer and floating point. If the format <code>integer</code> is used in this document or the object definitions, the meaning is that a service will send and expect integer values. The parsing must be compatible with parsing a number into an integer, because there is no distinction during transfer (<code>on the wire</code>). If the format is defined as <code>number</code>, neither client nor service may parse it as an integer.</p>
      <h4 id="language-tags">Language tags</h4>
      <p>The specified JSON format <code>language</code> allows the following tags:</p>
      <pre><code class="lang-javascript"><code class="hljs javascript">LANGUAGE TAGS
      [
      <span class="hljs-string">"af"</span>,    <span class="hljs-comment">//Afrikaans</span>
      <span class="hljs-string">"ar"</span>,    <span class="hljs-comment">//Arabic</span>
      <span class="hljs-string">"ar-ae"</span>, <span class="hljs-comment">//Arabic (U.A.E.)</span>
      <span class="hljs-string">"ar-bh"</span>, <span class="hljs-comment">//Arabic (Bahrain)</span>
      <span class="hljs-string">"ar-dz"</span>, <span class="hljs-comment">//Arabic (Algeria)</span>
      <span class="hljs-string">"ar-eg"</span>, <span class="hljs-comment">//Arabic (Egypt)</span>
      <span class="hljs-string">"ar-iq"</span>, <span class="hljs-comment">//Arabic (Iraq)</span>
      <span class="hljs-string">"ar-jo"</span>, <span class="hljs-comment">//Arabic (Jordan)</span>
      <span class="hljs-string">"ar-kw"</span>, <span class="hljs-comment">//Arabic (Kuwait)</span>
      <span class="hljs-string">"ar-lb"</span>, <span class="hljs-comment">//Arabic (Lebanon)</span>
      <span class="hljs-string">"ar-ly"</span>, <span class="hljs-comment">//Arabic (Libya)</span>
      <span class="hljs-string">"ar-ma"</span>, <span class="hljs-comment">//Arabic (Morocco)</span>
      <span class="hljs-string">"ar-om"</span>, <span class="hljs-comment">//Arabic (Oman)</span>
      <span class="hljs-string">"ar-qa"</span>, <span class="hljs-comment">//Arabic (Qatar)</span>
      <span class="hljs-string">"ar-sa"</span>, <span class="hljs-comment">//Arabic (Saudi Arabia)</span>
      <span class="hljs-string">"ar-sy"</span>, <span class="hljs-comment">//Arabic (Syria)</span>
      <span class="hljs-string">"ar-tn"</span>, <span class="hljs-comment">//Arabic (Tunisia)</span>
      <span class="hljs-string">"ar-ye"</span>, <span class="hljs-comment">//Arabic (Yemen)</span>
      <span class="hljs-string">"az"</span>,    <span class="hljs-comment">//Azerbaijanian</span>
      <span class="hljs-string">"be"</span>,    <span class="hljs-comment">//Belarusian</span>
      <span class="hljs-string">"bg"</span>,    <span class="hljs-comment">//Bulgarian</span>
      <span class="hljs-string">"bn"</span>,    <span class="hljs-comment">//Bengali</span>
      <span class="hljs-string">"bs"</span>,    <span class="hljs-comment">//Bosnian</span>
      <span class="hljs-string">"ca"</span>,    <span class="hljs-comment">//Catalan</span>
      <span class="hljs-string">"cs"</span>,    <span class="hljs-comment">//Czech</span>
      <span class="hljs-string">"da"</span>,    <span class="hljs-comment">//Danish</span>
      <span class="hljs-string">"de"</span>,    <span class="hljs-comment">//German</span>
      <span class="hljs-string">"de-at"</span>, <span class="hljs-comment">//German (Austria)</span>
      <span class="hljs-string">"de-ch"</span>, <span class="hljs-comment">//German (Switzerland)</span>
      <span class="hljs-string">"de-li"</span>, <span class="hljs-comment">//German (Liechtenstein)</span>
      <span class="hljs-string">"de-lu"</span>, <span class="hljs-comment">//German (Luxembourg)</span>
      <span class="hljs-string">"el"</span>,    <span class="hljs-comment">//Greek</span>
      <span class="hljs-string">"en"</span>,    <span class="hljs-comment">//English (Caribbean)</span>
      <span class="hljs-string">"en-au"</span>, <span class="hljs-comment">//English (Australia)</span>
      <span class="hljs-string">"en-bz"</span>, <span class="hljs-comment">//English (Belize)</span>
      <span class="hljs-string">"en-ca"</span>, <span class="hljs-comment">//English (Canada)</span>
      <span class="hljs-string">"en-cn"</span>, <span class="hljs-comment">//English (Chinese)</span>
      <span class="hljs-string">"en-gb"</span>, <span class="hljs-comment">//English (United Kingdom)</span>
      <span class="hljs-string">"en-ie"</span>, <span class="hljs-comment">//English (Ireland)</span>
      <span class="hljs-string">"en-ja"</span>, <span class="hljs-comment">//English (Japanese)</span>
      <span class="hljs-string">"en-jm"</span>, <span class="hljs-comment">//English (Jamaica)</span>
      <span class="hljs-string">"en-ko"</span>, <span class="hljs-comment">//English (Korean)</span>
      <span class="hljs-string">"en-nz"</span>, <span class="hljs-comment">//English (New Zealand)</span>
      <span class="hljs-string">"en-tt"</span>, <span class="hljs-comment">//English (Trinidad)</span>
      <span class="hljs-string">"en-tw"</span>, <span class="hljs-comment">//English (Taiwanese)</span>
      <span class="hljs-string">"en-us"</span>, <span class="hljs-comment">//English (United States)</span>
      <span class="hljs-string">"en-za"</span>, <span class="hljs-comment">//English (South Africa)</span>
      <span class="hljs-string">"es"</span>,    <span class="hljs-comment">//Spanish</span>
      <span class="hljs-string">"es-ar"</span>, <span class="hljs-comment">//Spanish (Argentina)</span>
      <span class="hljs-string">"es-bo"</span>, <span class="hljs-comment">//Spanish (Bolivia)</span>
      <span class="hljs-string">"es-cl"</span>, <span class="hljs-comment">//Spanish (Chile)</span>
      <span class="hljs-string">"es-co"</span>, <span class="hljs-comment">//Spanish (Colombia)</span>
      <span class="hljs-string">"es-cr"</span>, <span class="hljs-comment">//Spanish (Costa Rica)</span>
      <span class="hljs-string">"es-do"</span>, <span class="hljs-comment">//Spanish (Dominican Republic)</span>
      <span class="hljs-string">"es-ec"</span>, <span class="hljs-comment">//Spanish (Ecuador)</span>
      <span class="hljs-string">"es-gt"</span>, <span class="hljs-comment">//Spanish (Guatemala)</span>
      <span class="hljs-string">"es-hn"</span>, <span class="hljs-comment">//Spanish (Honduras)</span>
      <span class="hljs-string">"es-mx"</span>, <span class="hljs-comment">//Spanish (Mexico)</span>
      <span class="hljs-string">"es-ni"</span>, <span class="hljs-comment">//Spanish (Nicaragua)</span>
      <span class="hljs-string">"es-pa"</span>, <span class="hljs-comment">//Spanish (Panama)</span>
      <span class="hljs-string">"es-pe"</span>, <span class="hljs-comment">//Spanish (Peru)</span>
      <span class="hljs-string">"es-pr"</span>, <span class="hljs-comment">//Spanish (Puerto Rico)</span>
      <span class="hljs-string">"es-py"</span>, <span class="hljs-comment">//Spanish (Paraguay)</span>
      <span class="hljs-string">"es-sv"</span>, <span class="hljs-comment">//Spanish (El Salvador)</span>
      <span class="hljs-string">"es-uy"</span>, <span class="hljs-comment">//Spanish (Uruguay)</span>
      <span class="hljs-string">"es-ve"</span>, <span class="hljs-comment">//Spanish (Venezuela)</span>
      <span class="hljs-string">"et"</span>,    <span class="hljs-comment">//Estonian</span>
      <span class="hljs-string">"eu"</span>,    <span class="hljs-comment">//Basque (Basque)</span>
      <span class="hljs-string">"fa"</span>,    <span class="hljs-comment">//Farsi</span>
      <span class="hljs-string">"fi"</span>,    <span class="hljs-comment">//Finnish</span>
      <span class="hljs-string">"fo"</span>,    <span class="hljs-comment">//Faeroese</span>
      <span class="hljs-string">"fr"</span>,    <span class="hljs-comment">//French</span>
      <span class="hljs-string">"fr-be"</span>, <span class="hljs-comment">//French (Belgium)</span>
      <span class="hljs-string">"fr-ca"</span>, <span class="hljs-comment">//French (Canada)</span>
      <span class="hljs-string">"fr-ch"</span>, <span class="hljs-comment">//French (Switzerland)</span>
      <span class="hljs-string">"fr-lu"</span>, <span class="hljs-comment">//French (Luxembourg)</span>
      <span class="hljs-string">"ga"</span>,    <span class="hljs-comment">//Irish</span>
      <span class="hljs-string">"gd"</span>,    <span class="hljs-comment">//Gaelic (Scotland)</span>
      <span class="hljs-string">"gl"</span>,    <span class="hljs-comment">//Galician</span>
      <span class="hljs-string">"he"</span>,    <span class="hljs-comment">//Hebrew</span>
      <span class="hljs-string">"hi"</span>,    <span class="hljs-comment">//Hindi</span>
      <span class="hljs-string">"hr"</span>,    <span class="hljs-comment">//Croatian</span>
      <span class="hljs-string">"hu"</span>,    <span class="hljs-comment">//Hungarian</span>
      <span class="hljs-string">"hy"</span>,    <span class="hljs-comment">//Armenian</span>
      <span class="hljs-string">"id"</span>,    <span class="hljs-comment">//Indonesian</span>
      <span class="hljs-string">"is"</span>,    <span class="hljs-comment">//Icelandic</span>
      <span class="hljs-string">"it"</span>,    <span class="hljs-comment">//Italian</span>
      <span class="hljs-string">"it-ch"</span>, <span class="hljs-comment">//Italian (Switzerland)</span>
      <span class="hljs-string">"ja"</span>,    <span class="hljs-comment">//Japanese</span>
      <span class="hljs-string">"ji"</span>,    <span class="hljs-comment">//Yiddish</span>
      <span class="hljs-string">"ka"</span>,    <span class="hljs-comment">//Georgian</span>
      <span class="hljs-string">"ko"</span>,    <span class="hljs-comment">//Korean</span>
      <span class="hljs-string">"lb"</span>,    <span class="hljs-comment">//Luxembourgish</span>
      <span class="hljs-string">"lt"</span>,    <span class="hljs-comment">//Lithuanian</span>
      <span class="hljs-string">"lv"</span>,    <span class="hljs-comment">//Latvian</span>
      <span class="hljs-string">"mk"</span>,    <span class="hljs-comment">//Macedonian (FYROM)</span>
      <span class="hljs-string">"mn"</span>,    <span class="hljs-comment">//Mongolian</span>
      <span class="hljs-string">"ms"</span>,    <span class="hljs-comment">//Malaysian</span>
      <span class="hljs-string">"mt"</span>,    <span class="hljs-comment">//Maltese</span>
      <span class="hljs-string">"nl"</span>,    <span class="hljs-comment">//Dutch</span>
      <span class="hljs-string">"nl-be"</span>, <span class="hljs-comment">//Dutch (Belgium)</span>
      <span class="hljs-string">"no"</span>,    <span class="hljs-comment">//Norwegian</span>
      <span class="hljs-string">"pl"</span>,    <span class="hljs-comment">//Polish</span>
      <span class="hljs-string">"pt"</span>,    <span class="hljs-comment">//Portuguese (Portugal)</span>
      <span class="hljs-string">"pt-br"</span>, <span class="hljs-comment">//Portuguese (Brazil)</span>
      <span class="hljs-string">"pt-us"</span>, <span class="hljs-comment">//Portuguese (US)</span>
      <span class="hljs-string">"rm"</span>,    <span class="hljs-comment">//Rhaeto-Romanic</span>
      <span class="hljs-string">"ro"</span>,    <span class="hljs-comment">//Romanian</span>
      <span class="hljs-string">"ro-mo"</span>, <span class="hljs-comment">//Romanian (Republic of Moldova)</span>
      <span class="hljs-string">"ru"</span>,    <span class="hljs-comment">//Russian</span>
      <span class="hljs-string">"ru-mo"</span>, <span class="hljs-comment">//Russian (Republic of Moldova)</span>
      <span class="hljs-string">"sb"</span>,    <span class="hljs-comment">//Sorbian</span>
      <span class="hljs-string">"sk"</span>,    <span class="hljs-comment">//Slovak</span>
      <span class="hljs-string">"sl"</span>,    <span class="hljs-comment">//Slovenian</span>
      <span class="hljs-string">"sq"</span>,    <span class="hljs-comment">//Albanian</span>
      <span class="hljs-string">"sr"</span>,    <span class="hljs-comment">//Serbian (Cyrillic)</span>
      <span class="hljs-string">"sr"</span>,    <span class="hljs-comment">//Serbian (Latin)</span>
      <span class="hljs-string">"sv"</span>,    <span class="hljs-comment">//Swedish</span>
      <span class="hljs-string">"sv-fi"</span>, <span class="hljs-comment">//Swedish (Finland)</span>
      <span class="hljs-string">"sx"</span>,    <span class="hljs-comment">//Sutu</span>
      <span class="hljs-string">"sz"</span>,    <span class="hljs-comment">//Sami (Lappish)</span>
      <span class="hljs-string">"th"</span>,    <span class="hljs-comment">//Thai</span>
      <span class="hljs-string">"tn"</span>,    <span class="hljs-comment">//Tswana</span>
      <span class="hljs-string">"tr"</span>,    <span class="hljs-comment">//Turkish</span>
      <span class="hljs-string">"ts"</span>,    <span class="hljs-comment">//Tsonga</span>
      <span class="hljs-string">"uk"</span>,    <span class="hljs-comment">//Ukrainian</span>
      <span class="hljs-string">"ur"</span>,    <span class="hljs-comment">//Urdu</span>
      <span class="hljs-string">"uz"</span>,    <span class="hljs-comment">//Uzbek</span>
      <span class="hljs-string">"ve"</span>,    <span class="hljs-comment">//Venda</span>
      <span class="hljs-string">"vi"</span>,    <span class="hljs-comment">//Vietnamese</span>
      <span class="hljs-string">"xh"</span>,    <span class="hljs-comment">//Xhosa</span>
      <span class="hljs-string">"zh-cn"</span>, <span class="hljs-comment">//Chinese (PRC)</span>
      <span class="hljs-string">"zh-hk"</span>, <span class="hljs-comment">//Chinese (Hong Kong SAR)</span>
      <span class="hljs-string">"zh-sg"</span>, <span class="hljs-comment">//Chinese (Singapore)</span>
      <span class="hljs-string">"zh-tw"</span>, <span class="hljs-comment">//Chinese (Taiwan)</span>
      <span class="hljs-string">"zu"</span>     <span class="hljs-comment">//Zulu</span>
      ]</code>
      </code></pre>
      <h4 id="-a-name-servicecategorynames-a-service-category-names"><a name="serviceCategoryNames"></a>Service category names</h4>
      <p>Services are categorized to let clients register and find similar services. Services are found via <code>GET</code>on root level, using the query parameter <code>?servicecategory=&lt;name&gt;</code>, wherein <code>&lt;name&gt;</code> is one of the following category names:</p>
      <pre><code class="lang-javascript"><code class="hljs javascript">[
        <span class="hljs-string">"addresses"</span>,        <span class="hljs-comment">// address related information</span>
        <span class="hljs-string">"auth"</span>,             <span class="hljs-comment">// authentication and authorization</span>
        <span class="hljs-string">"car"</span>,              <span class="hljs-comment">// vehicle states, vehicle configurations</span>
        <span class="hljs-string">"cdn"</span>,              <span class="hljs-comment">// static content</span>
        <span class="hljs-string">"charging"</span>,         <span class="hljs-comment">// charging management</span>
        <span class="hljs-string">"ev"</span>,               <span class="hljs-comment">// electric vehicle information, states and configurations</span>
        <span class="hljs-string">"search"</span>,           <span class="hljs-comment">// dedicated searches that aggregate general searching</span>
        <span class="hljs-string">"hybrid"</span>,           <span class="hljs-comment">// HEV related information, states and configurations</span>
        <span class="hljs-string">"map"</span>,              <span class="hljs-comment">// digital map</span>
        <span class="hljs-string">"maprendering"</span>,     <span class="hljs-comment">// visual maps</span>
        <span class="hljs-string">"inputdevices"</span>,     <span class="hljs-comment">// input devices like optical sensors, hardkeys, capacitive keys</span>
        <span class="hljs-string">"media"</span>,            <span class="hljs-comment">// media related like rendering, queues(collections)</span>
        <span class="hljs-string">"medialibrary"</span>,     <span class="hljs-comment">// services hosting media items like tracks, albums or videos</span>
        <span class="hljs-string">"mixer"</span>,            <span class="hljs-comment">// audio management</span>
        <span class="hljs-string">"navigation"</span>        <span class="hljs-comment">// route calculation and navigation general</span>
        <span class="hljs-string">"communication"</span>,    <span class="hljs-comment">// phone, messaging etc.</span>
        <span class="hljs-string">"system"</span>,           <span class="hljs-comment">// system related, like performance, window management or registration</span>
        <span class="hljs-string">"radio"</span>,            <span class="hljs-comment">// radio</span>
        <span class="hljs-string">"speech"</span>,           <span class="hljs-comment">// speech dialogs</span>
        <span class="hljs-string">"swdl"</span>              <span class="hljs-comment">// all things related to software download</span>
      ]</code>
      </code></pre>
      <h4 id="language">Language</h4>
      <p>Every request may contain an <code>Accept-Language</code> Header field, which allows the client to let the service know about the accepted languages (cmp. <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">RFC2616#14.4</a>).</p>
      <p>In case of language depended content (e.g. city names), the service shall add the <code>Content-Language</code> Header to the response representing the actual language used to generate the content.</p>
      <h2 id="-a-name-uuidgeneration-a-uuid-generation"><a name="uuidGeneration"></a>uuid generation</h2>
      <p>The viwi protocol uses <code>uuid</code>s for element identification on different levels. A <code>uuid</code> is a 128bit number (dorucre <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">https://en.wikipedia.org/wiki/Universally_unique_identifier</a>). In its canonical form, a UUID is represented by 32 hexadecimal digits, displayed in five groups separated by hyphens, in the form <code>8-4-4-4-12</code> for a total of 36 characters (32 alphanumeric characters and four hyphens). 
      For example <code>5967e93f-40f9-4f39-893e-cc0da890db2e</code>.</p>
      <p>In the canonical representation, <code>xxxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx</code>, the most significant bits of N indicates the variant (depending on the variant; one, two, or three bits are used). The variant covered by the UUID specification is indicated by the two most significant bits of <code>N</code> being 1 0 (i.e., the hexadecimal <code>N</code> will always be 8, 9, A, or B).</p>
      <p><a href="https://www.ietf.org/rfc/rfc4122.txt">UUID specification</a> describes five versions. The four bits of <code>M</code> indicate the UUID <code>version</code> (i.e., the hexadecimal <code>M</code> will be either 1, 2, 3, 4, or 5).</p>
      <p>Each <code>version</code> uses different information to generate the <code>uuid</code> and thus some may be more appropriate than the others in specific use cases. According to the specification, Version 1 UUIDs are generated from date-time and MAC address, Version 2 UUIDs are generated from group or user id and date-time, Version 3 &amp; 5 produces deterministic UUIDs generated from a user-specified namespace and user-supplied data, and Version 4 is generated from pseudo-random number.</p>
      <p>For the ids generated by services in the context of this protocol, the use of Version 4 and Version 5 a recommended.</p>
      <h3 id="namespaces">Namespaces</h3>
      <p>Namespaces are, themselves, <code>uuid</code>s. While the UUID specification gives example UUIDs for namespaces corresponding to fully qualified domain names (DNS), URLs, ISO OIDs, and X.500 DNs, any UUID can be used as the namespace when generating Version 5 <code>uuid</code>s. Thus, nesting of namespaces is possible. A good practice is to use <code>&lt;service&gt;</code> and <code>&lt;resource&gt;</code> names for namespacing.</p>
      <h3 id="version-4-random-">Version 4 (random)</h3>
      <p>Version 4 UUIDs use a scheme relying only on random number generations.  This algorithm sets the version number (4 bits) as well as two reserved bits. All other bits (the remaining 122 bits) are set using a random or pseudorandom data source.  Version 4 UUIDs have the form</p>
      <pre><code><code class="hljs undefined">  xxxxxxxx-xxxx-4xxx-Yxxx-xxxxxxxxxxxx</code>
      </code></pre><p>where <code>x</code> is any hexadecimal digit and <code>Y</code> is one of 8, 9, A or B.</p>
      <h3 id="version-5-sha-1-hash-namespace-">Version 5 (SHA-1 hash &amp; namespace)</h3>
      <p>Version 5 UUIDs use a scheme with <code>SHA-1</code> hashing. Note that the 160 bit SHA-1 hash is truncated to 128 bits to make the length work out.</p>
      <h4 id="uniqueness-criteria">uniqueness criteria</h4>
      <p>In order to generate deterministic <code>uuid</code>s for entities that need to be recognized being identical on different systems, Version 5 shall be used. The characteristics used to determine similarity shall be used as inputs for the hashing function. An example for such an entity is a FM radio station, which is exactly characterized by its <code>ecc</code> and <code>pi</code> codes. The generation rule in this case would be</p>
      <pre><code><code class="hljs gcode">  uuid = sha<span class="hljs-number">1</span><span class="hljs-comment">(namespace.toBytes()</span>+eec.toBytes<span class="hljs-comment">()</span>+pi.toBytes<span class="hljs-comment">()</span>).substr<span class="hljs-comment">(0,32)</span>;</code>
      </code></pre><p>Thus, the same broadcasting station will get the same <code>uuid</code> on every system. Transferring presets based on station ids or finding the correct station icon becomes very easy when using this approach.</p>
      <p>The uniqueness criteria and thus the generation rule have to be defined on a per resource basis.</p>
      <h2 id="-a-name-interfacedesignpatterns-a-interface-design-patterns"><a name="InterfaceDesignPatterns"></a>Interface design patterns</h2>
      <h3 id="settings">Settings</h3>
      <p>When ever a service needs general settings which also may include a reset to factory defaults, a <code>settings</code> resource is used. The individual settings are evaluated by their name and value/state.</p>
      <h3 id="naturally-delayed-responses">Naturally delayed responses</h3>
      <p>There are cases, where a delayed and incremental results to a query can generally be expected. In case of Bluetooth device discovery for example a server side device scan has to be triggered. In these cases an immediate response to a GET request is neither possible nor practical for client side usage. The general pattern for these kind of applications/services should follow the principle :</p>
      <p>A <code>POST</code> request on resource level is used to create a new object. The client can subscribe to <code>on change</code> events for the newly created object or poll (<code>GET</code>) it continuously. The newly created object will change over time until completion. This pattern is applicable to:</p>
      <ul>
        <li>route calculation (/navigation/routes)</li>
        <li>device discovery (/bluetooth/scans)</li>
        <li>search auto completion (/deezer/searches)</li>
      </ul>
      <h3 id="server-vs-client-decision">Server vs. client decision</h3>
      <p>Instances that receive direct user input, like buttons, graphical user interfaces or key word activation shall be clients rather than servers. Servers have to serve multiple clients at once.</p>
      <h3 id="endpoint-naming">Endpoint naming</h3>
      <p>In addition to utilizing the HTTP verbs appropriately, <code>&lt;service&gt;</code> and <code>&lt;resource&gt;</code> naming is arguably the most debated and most important concept to grasp when creating an understandable, easily leveraged web service API. When resources are named well, an API is intuitive and easy to use. Done poorly, that same API can feel klutzy and be difficult to use and understand. The following rules are to follow for a well defined API syntax:</p>
      <ul>
        <li>for <code>&lt;service&gt;</code> names use the most specific noun possible to group its <code>&lt;resource&gt;</code>s</li>
        <li><code>&lt;resource&gt;</code> has to be a plural noun to express that it holds a list of <code>&lt;element&gt;</code>s</li>
        <li>APIs should be easily readable and understandable like <code>GET /media/renderers</code> or <code>DELETE /medialibrary/albums/ed757e27-ba8b-4a67-9798-360f78af6445?$fields=releasedate</code></li>
      </ul>
      <h3 id="property-and-enumeration-naming">Property and Enumeration naming</h3>
      <p>JSON properties are treated as keys in a map/dictionary. Thus, the property names are case-sensitive. In order to make the API more readable and consistent, property names and enumeration members shall be camelCased starting with a lower case character. Properties on the same object must not only be distinguishable by their casing, such a situation is considered a collision without technically being one.</p>
      <h3 id="using-inlined-objects">Using inlined objects</h3>
      <p>Following the design rule that every <code>XObject</code> in the system can be referenced by its own <code>uri</code>, use of inline object definitions is discouraged, as it limits the API capabilities such as filtering, expansion, property access and subscription. If optimized data structures (like structs in OO languages) are needed, first ask, if some other component may have an interest in the complex structure in question at all. If this is not the case consider moving the inlined object properties up to be regular properties of the <code>XObject</code>.
      Following rules should be respected:</p>
      <ul>
        <li>keep the number of levels low
        ** the object seems to complicated and a sub part is most likely to be referenced seperately</li>
        <li>keep the lists within an object short
      <strong> unclear how much data the client has to handel
      </strong> unclear how much data has to be transfered</li>
        <li>keep the number of properties in an object as low as possible
        ** filtering is generally not available in inlined objects</li>
        <li>keep the size of an object instance low
        ** filtering is generally not available in inlined objects</li>
      </ul>
      <h3 id="virtual-collection-content">Virtual collection content</h3>
      <p>There are cases in which an endpoint needs to present a list of items to strictly follow REST principles and/or to allow a convenient access to its information despite a lack of knowledge about these items. In particular, cases where a list is dynamically appended or prepended based on a selection made in this list by the holding object itself. An example for these use cases is a media renderer for bluetooth media - the next bluetooth track is only available once playback of this track has already started.</p>
      <p>The list will contain 0,1 or 2 virtual elements that are accessible but will just have a valid <code>id</code> and <code>uri</code> for as long as they are not pointed at. These elements will be placed at either end of the list. Once the element is referenced / pointed to by the client, an <code>atomic</code> action is executed:</p>
      <ul>
        <li>making the virtual element non-virtual</li>
        <li>creating a new virtual element</li>
        <li>extend the list</li>
      </ul>
      <p>Only on success, an update on the list and the reference is sent.</p>
      <p><img src="img/diagram3.png" alt="virtual elements"></p>
      <p><em>Using this approach would allow to conditionally show a previous/next button on client side depending on the relation between current item an List end/beginning. If an element follows, skip is available, if an element precedes, previous is available.</em></p>
      <p><strong>Note</strong> please be aware that this approach only works for unique list elements.Using an index instead of an item reference might be appropriate in some cases.</p>
      <h3 id="memory-management">Memory Management</h3>
      <p>Utilizing RSI as microservice architecture, there are multiple parties creating a lot of resource instances. This section describes a guideline regarding memory management.</p>
      <p>Typically, the lion's share of instances will be created by services themselves. The lifecycle of an instance is managed by the service that created it. In other words: Each service is responsible for deploying an reasonable memory management strategy (e.g. garbage collection).</p>
      <p><strong>Limitation</strong>
      While there won't be a prescribed strategy how to implement this feature, a service <em>must not</em> remove an instance</p>
      <ul>
        <li>any (other) party is subscribed to</li>
        <li>a known reference from another instance exists to</li>
      </ul>
      <p>On the other hand, if a client creates an instance, it should be aware of the footprint it is leaving and - if not longer required - remove the instance by deleting it contemporary.</p>
      <p>A consequence following the limitation mentioned above: If a client removes an instance another client has subscribed to in the meantime, the hosting service should send a appropriate status message (e.g. <em>409 conflict</em>) and keep the instance. The service is then responsible for managing this specific instance.</p>
      <pre><code><code class="hljs smali">As a rule of thumb the party who is creating an<span class="hljs-instruction"> instance </span>is responsible for managing its lifecycle.</code>
      </code></pre><h2 id="-a-name-apiversioning-a-api-versioning"><a name="APIversioning"></a>API versioning</h2>
      <p>Building APIs requires more thought up front than agile developer might be used to. Paths, data structure, meta-data and extensibility are important and would be best considered up front. Once those decisions have been made, changes to the structure would potentially result in breaking compatibility to older versions of the API. Thus, API design and setting some rules for future consistency is important.</p>
      <p>The versioning discussed in here only applies to the interface definition and does not tell anything about the service or client versions that implement the interface.</p>
      <h3 id="-a-name-semver-a-semantic-versioning"><a name="semVer"></a>Semantic versioning</h3>
      <p>The versioning is based on <a href="http://semver.org/">SemVer 2.0.0</a>. The rules defined there do apply with the following exception.</p>
      <p>The multi digit version number, separated by "." consists of the three:</p>
      <ul>
        <li>major: the API is <strong>entirely reworked</strong></li>
        <li>minor: the API has <strong>breaking changes</strong> to other versions</li>
        <li>patch: the API has <strong>compatible changes</strong> (including fixes) to other versions
      that compile to the version number <code>major.minor.patch</code></li>
      </ul>
      <p>The <code>major</code>version can also be considered as the generation which can be part of the root level uri seen in the document (e.g. <code>/api/v1/</code>).</p>
      <h4 id="reasons-for-changing-the-major-version">Reasons for changing the major version</h4>
      <p>In case of a total rework of the API, a new major version has to be used. The following actions are considered being a total rework:</p>
      <ul>
        <li>rearrangement/restructure of <code>&lt;service&gt;</code>s and their <code>&lt;resource&gt;</code>s, i.e. new <code>&lt;service&gt;</code>s are created, older disappear, resources are assigned to a different <code>&lt;service&gt;</code></li>
        <li>new general information and access methods are added that are incompatible with older versions in general</li>
      </ul>
      <h4 id="reasons-for-changing-the-minor-version">Reasons for changing the minor version</h4>
      <p>Changing the minor version indicates a breaking change or a noteworthy extension/enhancement of the API or general mechanisms. The following reasons are being considered noteworthy or breaking:</p>
      <ul>
        <li>deletion or renaming of properties</li>
        <li>changing semantics of properties (e.g. split into multiple properties)</li>
        <li>changing limits on the value range of a writable property</li>
        <li>add required properties for POST or PUT</li>
        <li>remove restrictions in the query result (e.g. a special order of a list)</li>
      </ul>
      <h4 id="reasons-for-changing-the-patch-version">Reasons for changing the patch version</h4>
      <p>The API will need continuous extension, so the versioning level <code>patch</code>is used to mark exactly those compatible changes. The following changes to the API are considered being compatible:</p>
      <ul>
        <li>add properties on object level</li>
        <li>add <code>&lt;service</code>&gt;s</li>
        <li>add <code>&lt;resource&gt;</code>s</li>
        <li>add general optional query parameters</li>
        <li>add general optional meta information to response or status objects</li>
        <li>add new formats</li>
        <li>Changing comments on property level and descriptions on any level, if these changes do NOT imply a semantic change of the API</li>
        <li>mark properties a being deprecated in the API comments (not their name)</li>
      </ul>
      <h4 id="deprecation">Deprecation</h4>
      <p>Entities on all level may be deprecated at some point in time. Following the versioning rules, an API can only be marked as <code>deprecated</code> on <code>patch</code> level, being removed earliest on <code>minor</code> level. Marking means putting a marker <code>@deprecated:</code> in front of the description of the entity in question. In case of a replacement, an additional marking <code>@replacedby:</code> is strongly recommended to be placed into the description too.</p>
      <h4 id="pre-release-tagging">Pre-release tagging</h4>
      <p>Any API version can be pre-released mainly for review purposes, following the pre-release rules of SemVer (§9 @ SemVer2.0.0).</p>
      <h4 id="-a-name-versionranges-a-version-ranges"><a name="versionranges"></a> version ranges</h4>
      <p>To express the support of a version range, a service might register with range notation. Only the SemVer (§9 @ SemVer2.0.0) notation <code>~</code> is supported and expresses a range:</p>
      <pre><code><code class="hljs fix"><span class="hljs-attribute">  1.4.1 &lt;</span>=<span class="hljs-string"> ~1.4.1 &lt; 1.5.0</span></code>
      </code></pre><p>The <code>^</code> notation is NOT supported.</p>
      <h4 id="-a-name-accessversionedinterface-a-accessing-the-interface-certain-version-"><a name="accessversionedinterface"></a>Accessing the interface (certain version)</h4>
      <p>To access a specific API version, the client has to provide the desired version indication in the Accept-Header. If no such information is provided, the latest available version is used.</p>
      <p>To indicate the desired version, the vendor tree following  <a href="http://tools.ietf.org/html/rfc4288#section-3.2">http://tools.ietf.org/html/rfc4288#section-3.2</a> is used:</p>
      <pre><code><code class="hljs xml">Accept: application/vnd.viwi.v<span class="hljs-tag">&lt;<span class="hljs-title">MAJOR</span>&gt;</span>.<span class="hljs-tag">&lt;<span class="hljs-title">MINOR</span>&gt;</span>.<span class="hljs-tag">&lt;<span class="hljs-title">PATCH</span>&gt;</span>+json</code>
      </code></pre><p>To access the API version 1.4.2 the Accept Header would be:</p>
      <pre><code><code class="hljs stylus">Accept: application/vnd<span class="hljs-class">.viwi</span><span class="hljs-class">.v1</span>.<span class="hljs-number">4.2</span>+json</code>
      </code></pre><p>The response API version shall be at least at the requested API version <code>patch</code> level. The response API version <strong>must</strong> at least match the requested <code>major</code> or <code>minor</code> version.</p>
      <h4 id="per-service-versioning">Per service versioning</h4>
      <p>Every <code>&lt;service&gt;</code> can work with its own API version, while the resources provided by this <code>&lt;service&gt;</code> have to be consistent with the <code>&lt;service&gt;</code> version.</p>
      <p>There is <strong>NO</strong> package versioning that groups <code>&lt;service&gt;</code> versions into an overall API (global) version.</p>
      <p>Every <code>&lt;service&gt;</code> will tell its supported versions by setting the <code>versions</code> property of the <code>&lt;service&gt;</code> object to a list of supported versions.</p>
      <h2 id="-a-name-service_registry-a-service-registry"><a name="service_registry"></a> Service registry</h2>
      <p>A service will register itself by <code>PUT</code>ing itself into the root level providing information about itself with the <a href="#serviceObject">serviceObject</a>. It can unregister itself by using <code>DELETE</code>.</p>
      <p>A detailed explanation of the registration process can be found in an external <code>ServiceRegistry_MSC_*</code> document.</p>
      <h3 id="-a-name-serviceobject-a-serviceobject"><a name="serviceObject"></a>serviceObject</h3>
      <p>In order to register a service with the <a href="#service_registry">service registry</a>, a special object called <code>serviceObject</code>, inherited from <a href="#XObject">XObject</a>, definition is available.</p>
      <pre><code class="lang-javascript"><code class="hljs javascript">{
        <span class="hljs-string">"id"</span>: {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-string">"description"</span>: <span class="hljs-string">"service id (if sent with registration request, it will be ignored by the registry)"</span>,
          <span class="hljs-string">"format"</span>: <span class="hljs-string">"uuid"</span>
        },
        <span class="hljs-string">"name"</span>: {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-string">"description"</span>: <span class="hljs-string">"service name"</span>
        },
        <span class="hljs-string">"uri"</span>: {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-string">"description"</span>: <span class="hljs-string">"service uri (the desired &lt;service_path&gt; relative to the root of the service registry)"</span>,
          <span class="hljs-string">"format"</span>: <span class="hljs-string">"uri"</span>
        },
        <span class="hljs-string">"description"</span>: {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-string">"description"</span>: <span class="hljs-string">"human readable description of the micro service"</span>
        },
        <span class="hljs-string">"port"</span>: {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"description"</span>: <span class="hljs-string">"TCP port the service is running on"</span>
        },
        <span class="hljs-string">"serviceCategories"</span>: {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>,
          <span class="hljs-string">"items"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"predefined key words"</span>
          }
        },
        <span class="hljs-string">"privileges"</span>:  {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>,
          <span class="hljs-string">"items"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"relative path to the service or resource"</span>
          }
        },
        <span class="hljs-string">"versions"</span>:  {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>,
          <span class="hljs-string">"items"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"supported version in semVer notation"</span>
          }
        }
      }</code>
      </code></pre>
      <p><code>privileges</code> lists the obtainable privileges for a service or resource.
      <code>serviceCategories</code> lists the <a href="#serviceCategoryNames">categories</a> a service is assigned to. The supported API versions are listed as strings in <a href="#semVer">semVer</a> format (major.minor.patch) under <code>version</code>.</p>
      <h3 id="registration">Registration</h3>
      <p>The service registers itself by providing the name it wants to be accessible under, relative to the root level uri (e.g. <code>/</code> or <code>/api/v1</code>).</p>
      <p>The registering service needs to provide privileges as an array containing the Micro Services access rights structure (e.g. /car/settings, /car/units, /tuner), i.e. privileges contains either a <code>&lt;service&gt;</code> list or a <code>/&lt;service&gt;/&lt;resource&gt;/</code> list. <code>&lt;service&gt;</code>s and <code>/&lt;service&gt;/&lt;resource&gt;/</code> may be mixed in this list.</p>
      <p>The service registry generates an id (uuid) for the service and responds with the newly registered services id in the <code>Location</code> header like in the following example:</p>
      <pre><code><code class="hljs xml">Location: https://<span class="hljs-tag">&lt;<span class="hljs-title">IP-address_of_service_registry</span>&gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-title">port_of_service_registry</span>&gt;</span>/api/v1/<span class="hljs-tag">&lt;<span class="hljs-title">uuid_of_service</span>&gt;</span></code>
      </code></pre><p>or</p>
      <pre><code><code class="hljs http"><span class="hljs-attribute">Location</span>: <span class="hljs-string">/&lt;uuid_of_service&gt;</span></code>
      </code></pre><p>Refer to <a href="#versionranges">version ranges</a> to determine the necessary versions notation.</p>
      <p>registration example:</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">PUT <span class="hljs-string">/&lt;service_path&gt;</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json;q=0.8</span>
      
      <span class="apache">
      <span class="hljs-tag">&lt;serviceObject&gt;</span></span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">201</span> Created</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      <span class="hljs-attribute">Location</span>: <span class="hljs-string">&lt;URI of created service&gt;</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>": <span class="hljs-value"><span class="hljs-string">"ok"</span>
      </span>}</span></code>
      </code></pre><h3 id="unregistration">Unregistration</h3>
      <p>Unregistration is only allowed on <code>id</code> level, i.e. by sending <code>DELETE</code>. <code>DELETE</code> requests on other accessing paths will result in a <a href="#httpstatuscodes">status code</a> 400 Bad request</p>
      <p>request:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">DELETE <span class="hljs-string">/&lt;service_uuid&gt;</span> HTTP/1.1</span>
      <span class="hljs-attribute">Host</span>: <span class="hljs-string">127.0.0.1:1337</span>
      <span class="hljs-attribute">Accept</span>: <span class="hljs-string">application/json;q=0.8</span></code>
      </code></pre><p>response:</p>
      <pre><code><code class="hljs http"><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
      <span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">application/json; charset=utf-8</span>
      
      <span class="json">
      {
        "<span class="hljs-attribute">status</span>": <span class="hljs-value"><span class="hljs-string">"ok"</span>
      </span>}</span></code>
      </code></pre><p>Only the entity which has registered the service is allowed to unregister the service. If the wrong user (client or service) tries to delete the service, the Service Registry will deny the <code>DELETE</code> request by sending the HTTP 403 Forbidden <a href="#httpstatuscodes">status code</a>.</p>
      <h3 id="valid-status-codes">valid status codes</h3>
      <p>The Service Registry may respond with different status codes, depending on the requested action. The <code>30X</code> range differs from regular viwi.</p>
      <table>
        <thead>
          <tr>
            <th>code</th>
            <th>content type</th>
            <th>meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>200</td>
            <td>content type</td>
            <td>request successful, regular content follows</td>
          </tr>
          <tr>
            <td>201</td>
            <td>content type</td>
            <td>creation succeeded, Location header set</td>
          </tr>
          <tr>
            <td>300</td>
            <td>list of potential redirect uris</td>
            <td>Multiple matches found, client has to decide</td>
          </tr>
          <tr>
            <td>307</td>
            <td>no payload, just redirect</td>
            <td>Exact match found</td>
          </tr>
        </tbody>
      </table>
      <h2 id="-a-name-userauth-a-user-authentication-and-authorization"><a name="userauth"></a>User Authentication and Authorization</h2>
      <p>In order to secure API access and to guarantee delivery of authorized content only, a token mechanism (cmp. <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0 - RFC6749</a>, <a href="https://tools.ietf.org/html/rfc7519">JWT - RFC7519</a>) is used. The token mechanism can be understood as a dedicated valet key for valet services. This key often only allows the car to be driven a particular distance, and typically does not unlock the trunk and the glove box. OAuth is often referred to as a valet key for the web in that it grants an application access to protected data only for specific use cases and often for a limited amount of time. Also, authentication via tokens never requires actually passing user credentials from one client or service to another. Once the OAuth authentication and validation process begins, the user is redirected to a secure URL where credentials are requested, but those credentials are never shared outside of that secure URL.</p>
      <p>HTTP provides a dedicated <code>Authorization</code> Header for transferring the <code>accessToken</code> with each request or an <code>idToken</code> with the login request. In case of indirect request, i.e. request a service to deliver information that rely on another services information, the <code>accessToken</code> might be handed from one to the other service.</p>
      <p>WebSockets multiplex messages that might need authorization, so the <code>subscribe</code> message (<a href="#PublishSubscribe">Publish Subscribe</a>) contains the optional <code>authorization</code> property. Once an <code>accessToken</code> expires, the corresponding subscription(s) will send an <code>error</code> message with the error code 403. This is the indication that a new subscription with a valid token has to be setup or a reauthorization of the subscription with a new, valid <code>accessToken</code> is needed.</p>
      <h3 id="token-types">Token types</h3>
      <p>The following section gives a short overview of technologies that best fit the needs of the protocol. The type of the token to be used in an actual implementation may vary from <code>&lt;service&gt;</code> to <code>&lt;service&gt;</code>, if not otherwise specified in an overall system specification. The protocol itself is neither limited nor does it benefit from choosing the one or the other alternative.</p>
      <h4 id="-a-name-auth_jwt-a-jwt"><a name="auth_JWT"></a> JWT</h4>
      <p>JSON Web Token (JWT) is an open standard <a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a> that defines a compact and <strong>self-contained</strong> way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed. JWTs can generally be signed using a secret (with the HMAC algorithm) or a public/private key pair using RSA.</p>
      <p>For the application to the protocol, the token issuer (<code>iss</code> claim) has to provide access to its public key (<code>sigurl</code>claim) for token verification. The payload contains all the required information like the scope (<code>scp</code> claim), avoiding the need to query the database more than once, thus they are called <strong>self-contained</strong>. Token verification is crucial and MUST be implemented by all service handling sensitive information.</p>
      <p>JWT tokens will be sent in the <code>Authorization</code> header, following with term <code>JWT</code> and a space character.</p>
      <p>Example that assumes <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiSm9obiBEb2UifQ.xuEv8qrfXu424LZk8bVgr9MQJUIrp1rHcPyZw_KSsds</code> is the actual token:</p>
      <pre><code><code class="hljs stylus">  GET /&lt;service&gt;/&lt;resource&gt;/ HTTP/<span class="hljs-number">1.1</span>
        Host: <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">1337</span>
        Authorization: JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9<span class="hljs-class">.eyJuYW1lIjoiSm9obiBEb2UifQ</span><span class="hljs-class">.xuEv8qrfXu424LZk8bVgr9MQJUIrp1rHcPyZw_KSsds</span></code>
      </code></pre><h5 id="expiry">Expiry</h5>
      <p>JWTs are stateless keys to information that needs to protected. Therefore a token has to be <em>revokable</em>. As the underlying concept of self-containing tokens does not allow revocation by a central component on a request by request basis, JWTs shall expiry quickly. This makes the possible time window for using a token without permission small.</p>
      <h5 id="identification">Identification</h5>
      <p>Every JWT shall contain a <code>jti</code> claim in its header to ensure blacklisting possibilities and to allow one time use.</p>
      <h5 id="trust-decisions">Trust decisions</h5>
      <p>The contents of a JWT cannot be relied upon in a trust decision unless its contents have been cryptographically secured and bound to the context necessary for the trust decision. In particular, the key(s) used to sign and/or encrypt the JWT will typically be under the control of the party identified as the issuer of the JWT.</p>
      <p>Every JWT shall contain an <code>iss</code> (issuer) claim in its header to identify the principal that issued the token by its absolute <code>uri</code>.</p>
      <h5 id="privacy-considerations">Privacy considerations</h5>
      <p>A JWT may contain privacy-sensitive information. When this is the case, measures must be taken to prevent disclosure of this
      information to unintended parties. One way to achieve this is to use an encrypted JWT. Another way is to ensure that JWTs containing unencrypted privacy-sensitive information are only transmitted over encrypted channels or protocols, such as TLS. Those Tokens MUST NOT be shared between services.</p>
      <h4 id="-a-name-auth_oauth-a-oauth"><a name="auth_OAuth"></a> OAuth</h4>
      <p>Other than the <a href="#auth_JWT">JWT</a>, an OAuth Token does not carry any information about the user, the scope etc. The OAuth Token is therefore more compact. In order to obtain information about privileges, a services needs to ask the issuer of the token for its validity before responding. The big advantage is that the Token does not have to expire, because it can be revoked between requests easily. The down side is of course the number of requests sent to and from the token issuer.</p>
      <p>OAuth tokens are sent with the <code>Authorization</code> header, following with term <code>Bearer</code> and a space character.</p>
      <p>Example that assumes <code>mF_9.B5f-4.1JqM</code> is the actual token:</p>
      <pre><code><code class="hljs xml">  GET /<span class="hljs-tag">&lt;<span class="hljs-title">service</span>&gt;</span>/<span class="hljs-tag">&lt;<span class="hljs-title">resource</span>&gt;</span>/ HTTP/1.1
        Host: 127.0.0.1:1337
        Authorization: Bearer mF_9.B5f-4.1JqM</code>
      </code></pre><h3 id="authentication-process-security-recommendation-">Authentication Process &amp; Security (recommendation)</h3>
      <p>Applying the token mechanisms discussed earlier in this chapter allows authentication and authorization based on these tokens.</p>
      <h4 id="security-by-osi-level">Security by OSI Level</h4>
      <p>For security reasons, the system has to implement specific security related mechanisms on different levels of the networking layer:</p>
      <table>
      <thead>
      <tr>
      <th>OSI</th>
      <th></th>
      <th>mechanism</th>
      <th>Protocol(s)</th>
      </tr>
      </thead>
      <tbody>
      <tr>
      <td>7</td>
      <td>Application</td>
      <td>Token Authentication + Authorization</td>
      <td>HTTPS + secure WebSocket</td>
      </tr>
      <tr>
      <td>6</td>
      <td>Presentation</td>
      <td></td>
      <td></td>
      </tr>
      <tr>
      <td>5</td>
      <td>Session</td>
      <td>encryption</td>
      <td>TLS</td>
      </tr>
      <tr>
      <td>4</td>
      <td>Transport</td>
      <td>Firewall</td>
      <td>TCP</td>
      </tr>
      <tr>
      <td>3</td>
      <td>Network</td>
      <td>Firewall</td>
      <td>IP</td>
      </tr>
      <tr>
      <td>2</td>
      <td>Data-Link</td>
      <td></td>
      <td></td>
      </tr>
      <tr>
      <td>1</td>
      <td>Physical</td>
      <td></td>
      </tr>
      </tbody>
      </table>
      <h4 id="firewall">Firewall</h4>
      <p>Each server shall be assigned a port number, on demand or per runtime configuration, based on the general security requirements for the system. A firewall shall ONLY let the traffic pass it is configured for. All other ports shall be blocked by default. </p>
      <h4 id="transport-layer-security">Transport Layer Security</h4>
      <p>To secure the transfer of messages, transport layer security shall be established through the TLS protocol. For more detailed requirements on the required TLS version and cipher suites. Whether a concrete interface needs to be encrypted is subject of the security specification.
      All necessary measures to allow TLS must be implemented, such as reliable time and secure certificate storage on the device using the certificate to authenticate, in case of mutual auth.</p>
      <h5 id="communication-types">Communication types</h5>
      <p>There are two different types of communication – internal and external.
      Communication is considered internal when two trusted devices communicate with each other, e.g. the communication between two ECUs that are under full control (quality, security, testing etc.) of the vendor is considered <code>internal</code> while the communication with at least one 3rd party device is considered <code>external</code> (e.g. Smartphone).</p>
      <h4 id="use-cases">Use Cases</h4>
      <p>For the different use case for API usage, different cipher suites and ssl versions are recommended:</p>
      <table>
      <thead>
      <tr>
      <th>Communication between</th>
      <th>Cipher Suite</th>
      <th>Minimum supported SSL libraries (most recent incl. bug fixes may be needed)</th>
      </tr>
      </thead>
      <tbody>
      <tr>
      <td>vehicle internal clients with encryption, with token based authentication (default - internal)</td>
      <td>TLS_PSK_WITH_AES_128_CBC_SHA256</td>
      <td>OpenSSL 1.0.2l, OpenSSL 1.1.0f, wolfSSL 3.10.0</td>
      </tr>
      <tr>
      <td>vehicle internal clients with encryption, with tls based authentication (e.g. certificate) (mutual auth with certificate pinning)</td>
      <td>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 with ECC: secp256r1 (prime256v1)</td>
      <td>OpenSSL 1.0.2l, OpenSSL 1.1.0f, wolfSSL 3.10.0</td>
      </tr>
      <tr>
      <td>vehicle internal clients without encryption, with authentication (might be decided to be used on per-service basis)</td>
      <td>TLS_PSK_WITH_NULL_SHA256</td>
      <td>OpenSSL 1.0.2l, OpenSSL 1.1.0f, wolfSSL 3.10.0</td>
      </tr>
      <tr>
      <td>vehicle and vehicle external clients with encryption, with token based authentication (e.g. certificate) (default - external)</td>
      <td>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 with ECC: secp256r1 (prime256v1)</td>
      <td>OpenSSL 1.0.2l, OpenSSL 1.1.0f, wolfSSL 3.10.0</td>
      </tr>
      <tr>
      <td>vehicle and vehicle external clients without encryption or without authentication</td>
      <td>-</td>
      <td>Not allowed</td>
      </tr>
      </tbody>
      </table>
      <p> </p>
      <h4 id="token-based-authentication-authorization">Token based Authentication &amp; Authorization</h4>
      <p>On a case by case basis a token based authorization and authentication mechanism used to grant access to RSI APIs shall be applied. Therefore, a central access rights management service implementation is recommended. Token types JWT and Bearer (e.g. OAuth3) as defined above shall be supported.</p>
      <h5 id="general-approach">General approach</h5>
      <p>The RSI security concept relies on token mechanisms known from OAuth or OpenId approaches. It uses <code>idToken</code> and <code>accessToken</code> exchange for scoping API access (authorization) and authentication. The image below shows a brief overview</p>
      <h5 id="skeleton-of-the-idtoken-">Skeleton of the <code>idToken</code></h5>
      <p>The <code>idToken</code> is a JWT (<a href="https://jwt.io">https://jwt.io</a>, <a href="https://tools.ietf.org/html/rfc7519">https://tools.ietf.org/html/rfc7519</a>) Token. The token can be signed by a trusted entity.</p>
      <h6 id="token-header">Token Header</h6>
      <p>Claims in the <code>idToken</code> header are – find the claim key for JSON in parentheses:</p>
      <h7 id="issuer-iss-">Issuer (iss)</h7>
      <p>The <code>iss</code> (issuer) claim identifies the principal that issued the JWT. The processing of this claim is generally application specific.The "iss" value is a case-sensitive string containing a String or URI value. This claim is MANDATORY.</p>
      <h7 id="link-to-public-key-used-for-signature-sigurl-">Link to public key used for signature (sigurl)</h7>
      <p>The <code>sigurl</code> claim (signature url) contains an url pointing to the public key to be applied for token signature verification. This public key has to be assigned to and issued by a trusted source. This claim is MANDATORY.</p>
      <h7 id="issuing-date-iat-">Issuing date (iat)</h7>
      <p>The <code>iat</code> (issued at) claim identifies the time at which the JWT was issued. This claim can be used to determine the age of the JWT. Its value MUST be a unix timestamp. This claim is MANDATORY.</p>
      <h7 id="expiration-time-exp-">Expiration time (exp)</h7>
      <p>The <code>exp</code> (expiration time) claim identifies the expiration time on or after which the JWT MUST NOT be accepted for processing. The processing of the <code>exp</code> claim requires that the current date/time MUST be before the expiration date/time listed in the <code>exp</code> claim. Implementers MAY provide for some small leeway, usually no more than a few minutes, to account for clock skew. Its value MUST be a unix timestamp. This claim is MANDATORY.</p>
      <h7 id="jwt-identifier-jti-">JWT identifier (jti)</h7>
      <p>The <code>jti</code> (JWT ID) claim provides a unique identifier for the JWT. The identifier value MUST be assigned in a manner that ensures that there is a negligible probability that the same value will be accidentally assigned to a different data object The <code>jti</code> claim can be used to prevent the JWT from being replayed. The <code>jti</code> value is a case-sensitive string, it SHALL be used to revoke a token. This claim is MANDATORY.</p>
      <h6 id="token-payload">Token payload</h6>
      <p>Mandatory claims in the <code>idToken</code> payload – find the claim key for JSON in parentheses:</p>
      <h7 id="client-id-cid-">Client Id (cid)</h7>
      <p>The <code>cid</code> (Client Id) claim provides a unique identifier for the Client requesting authorization. The identifier value MUST be assigned in a manner that ensures that there is a negligible probability that the same value will be accidentally assigned to a client. The <code>cid</code> claim SHALL be used to prevent the JWT from being used by unauthorized clients. The <code>cid</code> value is a case-sensitive string. This claim is MANDATORY.</p>
      <h7 id="username-userid-uid-">Username/Userid (uid)</h7>
      <p>The <code>uid</code> (User Id) claim provides a unique identifier for the User requesting authorization. Usually the <code>uid</code> claim will hold the users username or user id. The <code>uid</code> claim MUST be used to prevent the JWT from being used by unauthorized users. The <code>cid</code> value is a case-sensitive string. The <code>uid</code> MUST be compared to the user logged in on the main unit. In case of a match, the Token is sufficient for authorization, if there is no match, the active user on the main unit MUST be asked for (temporary) access by any means of user interaction (e.g. popup). This claim is MANDATORY.</p>
      <h7 id="scope-scp-">Scope (scp)</h7>
      <p>The <code>scp</code> (Scope) claim provides a set of information about the APIs, a particular <code>uid</code> and <code>cid</code> combination is authorized to use. The <code>uid</code> claim MUST be used to prevent the APIs from being used by unauthorized users or unauthorized clients. The <code>cid</code> value is a JSON object describing the access rights on a per resource basis. This claim is MANDATORY.</p>
      <h6 id="scoping">Scoping</h6>
      <p>As the scope claim holds a complex structure, its data definition is elaborated more in detail. The scope MUST express the resource as a key and the access modes as an array of string in its value. Known modes are Create/Read/Update/Delete (CRUD). The scope object sent with the <code>idToken</code> MUST validate against the following JSONschema:</p>
      <pre><code><code class="hljs json">{
        "<span class="hljs-attribute">$schema</span>": <span class="hljs-value"><span class="hljs-string">"http://json-schema.org/draft-06/schema#"</span></span>,
        "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"object"</span></span>,
        "<span class="hljs-attribute">patternProperties</span>": <span class="hljs-value">{
        "<span class="hljs-attribute">^\/[A-Za-z0-9_]+\/[A-Za-z0-9_]+\/$</span>": <span class="hljs-value">{
          "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"array"</span></span>,
          "<span class="hljs-attribute">items</span>": <span class="hljs-value">{
           "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
            "<span class="hljs-attribute">enum</span>": <span class="hljs-value">[
              <span class="hljs-string">"create"</span>,
              <span class="hljs-string">"read"</span>,
              <span class="hljs-string">"update"</span>,
              <span class="hljs-string">"delete"</span>
              ]
            </span>}
          </span>}
        </span>}</span>,
        "<span class="hljs-attribute">additionalProperties</span>": <span class="hljs-value"><span class="hljs-literal">false</span>
      </span>}</code>
      </code></pre><p>An example scope object which validates against above schema:</p>
      <pre><code><code class="hljs json">{
        "<span class="hljs-attribute">/media/renderers/</span>": <span class="hljs-value">[<span class="hljs-string">"read"</span>, <span class="hljs-string">"update"</span>]</span>,
        "<span class="hljs-attribute">/media/collections/</span>": <span class="hljs-value">[<span class="hljs-string">"create"</span>, <span class="hljs-string">"read"</span>, <span class="hljs-string">"update"</span>, <span class="hljs-string">"delete"</span>]
      </span>}</code>
      </code></pre><h7 id="read">Read</h7>
      <p>List resource content, read element details, converts to GET on resource and element level in RSI.</p>
      <h7 id="create">Create</h7>
      <p>Allows a client to create new entities in the RSI space, converts into POST on resource level or PUT on element level. Implies Read access.</p>
      <h7 id="update">Update</h7>
      <p>Update elements by using POST on element level. Implies Read access.</p>
      <h7 id="delete">Delete</h7>
      <p>DELETE elements from resources or DELETE properties on element level. Implies Read access.</p>
      <h6 id="login-process-idtoken-retrieval">Login process / <code>idToken</code> retrieval</h6>
      <p>There are one to two steps to retrieve the <code>idToken</code>. A login can be performed multiple times. Every time a login is performed, the full procedure (e.g. requesting user interaction) is underwent.</p>
      <h6 id="token-creation">Token creation</h6>
      <p>A client application MUST create a local JWT token based on the information given in 4.2. The Token can be signed OPTIONALY by an authorized entity. After this step an UNSIGNED Token is available.</p>
      <h6 id="signing-the-token">Signing the token</h6>
      <p>The token is then sent to the signing entity (e.g. MBB) together with all credentials needed to authenticate the user requesting the signature, i.e. login information. The user specified in the <code>uid</code> claim MUST be the user requesting signature. The signing entity has to check permissions of the user and collate them with the requested resources stated in the <code>scope</code> claim. Signature MUST only be applied when all checks are positive and the user shall be granted access to the resources scoped for the particular client (<code>cid</code> claim) that requested. After this step a SIGNED Token is available.</p>
      <h6 id="revocation">Revocation</h6>
      <p>An <code>idToken</code> carries its own identifier, so the Backend system signing the <code>idToken</code>s MUST provide a mechanism for the Auth-Service to check if a certain token is still valid. A push mechanism for token revocation SHALL be implemented as well. The Auth-Service SHALL be able to listen for changes on tokens it “knows”, i.e. the Auth-Service provides a list of token identifiers to listen on for updates.
      The Auth-Service MUST implement a TRL (Token Revocation List) that contains the revoked token identifiers (jti) as described above. Independenly of the token being revoked remotely or locally (offline and friends in the car use cases), the jti has to be maintained in the TRL.</p>
      <h5 id="access-token">Access token</h5>
      <p>An access token is needed to access the APIs of the head unit. The <code>accessToken</code> is sent by the client with each request and with each WebSocket subscription. The AuthService MUST deny access any API access without a token being provided. The tokens validity MUST be checked for each request and before any Websocket update. The <code>accessToken</code> is Bearer token with a maximum length of 255 characters, i.e. a caseSenstive string value of maximum 255 characters. The token length SHALL be limited to a reasonable size.
       <code>accessToken</code>s are strictly bound to the user who granted access, i.e. in a single user system they are only valid for the resources of the logged in user, in a multi user system, <code>accessToken</code>s can be used to access information of users known to the system, but not logged in on the system during the access time.</p>
      <h6 id="retrieval">Retrieval</h6>
      <p>The <code>idToken</code> is sent to the main unit with the Authorization header on POST /auth/logins/ to request the creation of a viwi.service.auth loginObject. Example:</p>
      <pre><code><code class="hljs http"><span class="hljs-request">POST <span class="hljs-string">/auth/logins/</span> HTTP/1.1</span>
        <span class="hljs-attribute">Host</span>: <span class="hljs-string">172.0.0.1:443</span>
        <span class="hljs-attribute">Authorization</span>: <span class="hljs-string">JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiSm9obiBEb2UifQ.xuEv8qrfXu424LZk8bVgr9MQJUIrp1rHcPyZw_KSsds</span></code>
      </code></pre><p>Every <code>idToken</code> MUST be checked and a specific <code>accessToken</code> for the system and the particular <code>idToken</code> MUST be provided in exchange by the authorization service (<code>/auth/</code>), therefore it will only work for a particular user on a particular system for a particular client. The <code>accessToken</code> and its expiration timestamp MUST be sent with the headers (<code>Authorization</code> and <code>Expires</code>) of the HTTP response. If the current system user matches the user specified in the <code>uid</code> claim, authorization MUST pass through without any further user interaction. If either the user specified in the <code>uid</code> claim does NOT match the current system user – friends in the car mode – or the token is not signed by a trusted authorization entity (e.g. Backend) – offline use case – the system MUST ask the user to grant (temporary) access to the scope defined in the token. If the integrity of the <code>idToken</code> cannot be proven (manipulated token), the system MUST deny access. An <code>accessToken</code> MUST only be responded – in the response body – after authorization is granted. The system MUST have a list of valid tokens that is checked on every request and WebSocket update.</p>
      <h6 id="revocation-expiration">Revocation / expiration</h6>
      <p>The Headunit MUST revoke an <code>accessToken</code> once the <code>idToken</code> it was created based on expires or if the <code>idToken</code> is revoked itself. If an <code>accessToken</code> is not valid anymore, all API access MUST be prohibited. On Expiration or revocation re-retrieval of a new <code>accessToken</code> MUST be executed by the client. An appropriate status code MUST be sent as a response. A reliable time MUST be available to check validity/expiration.</p>
      <h6 id="refresh">Refresh</h6>
      <p>There is no such thing like a refresh token in regular OAuth, because at any time, a new <code>accessToken</code> can be obtained by handing over a valid <code>idToken</code>.</p>
      <h5 id="api-access">API access</h5>
      <p>The client MUST send the <code>accessToken</code> with each request and each Websocket subscription. API access MUST be denied if no token is given or is invalidated for any reason.</p>
      <h5 id="token-sequence-overview">Token sequence overview</h5>
      <p>The following diagram shows a brief overview of the authentication and authorization flow, omitting details like the actual HTTPS calls and Websocket message syntax. The viwi.service.auth service definition contains the object description for the <a href="#loginObject">loginObject</a>.</p>
      <p><img src="img/diagram6.png" alt="Authentication &amp; Authorization workflow"></p>
      <h4 id="scope-check">Scope check</h4>
      <p>As a Client may not be granted the full access requested by the scope set in its <code>idToken</code>, The /auth/logins/loginObject MUST carriy the scope a client was granted access for as an embedded structure of the same kind given by the <code>idToken</code> definition. At any time, a client MUST be able to query the loginObject created during the login process, providing a valid <code>accessToken</code>. A Client SHALL register for changes on this loginObject in case a user revokes or grants access rights after the login.
      A Client MIGHT use the scope information to adapt its User Interface (UI). A Client may reask for permission at any time.</p>
      </article>
    </section>
  </body>
</html>